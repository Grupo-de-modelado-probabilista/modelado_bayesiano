<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modelado Bayesiano - 7&nbsp; Regresión lineal con Bambi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./07_Comparación_de_modelos.html" rel="next">
<link href="./05_Regresión_lineal.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B8PPDKVG6F"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-B8PPDKVG6F', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="[7]{.chapter-number}&nbsp; [Regresión lineal con Bambi]{.chapter-title}">
<meta name="citation_publication_date" content="2023-04-21">
<meta name="citation_cover_date" content="2023-04-21">
<meta name="citation_year" content="2023">
<meta name="citation_fulltext_html_url" content="https://gmp.net.ar/modelado_bayesiano/">
<meta name="citation_doi" content="https://doi.org/10.5281/zenodo.7851296">
<meta name="citation_language" content="es">
<meta name="citation_book_title" content="Modelado Bayesiano">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./06_Regresión_lineal_con_Bambi.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Modelado Bayesiano</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="github" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="github"><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano">
            Fuente
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Grupo-de-modelado-probabilista/Modelado_Bayesiano/issues/new">
            Reportar errores
            </a>
          </li>
      </ul>
    </div>
    <a href="https://twitter.com/aloctavodia" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://bayes.club/@aloctavodia" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-mastodon"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Modo claro/oscuro"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Modo sin distracciones">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">‎</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_Probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Inferencia_Bayesiana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferencia Bayesiana</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Programación_probabilística.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programación probabilista</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Modelos_jerárquicos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelado Jerárquico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_Diagnóstico_MCMC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Diagnóstico del muestreo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_Regresión_lineal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Regresión_lineal_con_Bambi.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Comparación_de_modelos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Comparación de modelos</span></span></a>
  </div>
</li>
    </ul>
    </div>
<div class="quarto-sidebar-footer"><div class="sidebar-footer-item">
<center>
<br>¡Apoya la creación de contenido con una donación! (solo pagos Argentina)<a href="https://cafecito.app/aloctavodia" rel="noopener" target="_blank"><img srcset="https://cdn.cafecito.app/imgs/buttons/button_6.png 1x, https://cdn.cafecito.app/imgs/buttons/button_6_2x.png 2x, https://cdn.cafecito.app/imgs/buttons/button_6_3.75x.png 3.75x" src="https://cdn.cafecito.app/imgs/buttons/button_6.png" alt="Invitame un café en cafecito.app"></a><br><br>Support content creation with a donation! (Pay from everywhere)<a href="https://ko-fi.com/B0B5SN6SD" target="_blank"><img height="36" style="border:0px;height:36px;" src="https://storage.ko-fi.com/cdn/kofi1.png?v=3" border="0" alt="Buy Me a Coffee at ko-fi.com"></a>
</center>
</div></div></nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#una-sintaxis-para-gobernarlos-a-todos" id="toc-una-sintaxis-para-gobernarlos-a-todos" class="nav-link active" data-scroll-target="#una-sintaxis-para-gobernarlos-a-todos"><span class="header-section-number">7.1</span> Una sintaxis para gobernarlos a todos</a></li>
  <li><a href="#bicicletas-bambinas" id="toc-bicicletas-bambinas" class="nav-link" data-scroll-target="#bicicletas-bambinas"><span class="header-section-number">7.2</span> Bicicletas bambinas</a></li>
  <li><a href="#regresión-polinomial" id="toc-regresión-polinomial" class="nav-link" data-scroll-target="#regresión-polinomial"><span class="header-section-number">7.3</span> Regresión polinomial</a></li>
  <li><a href="#splines" id="toc-splines" class="nav-link" data-scroll-target="#splines"><span class="header-section-number">7.4</span> Splines</a></li>
  <li><a href="#modelos-distribucionales" id="toc-modelos-distribucionales" class="nav-link" data-scroll-target="#modelos-distribucionales"><span class="header-section-number">7.5</span> Modelos distribucionales</a></li>
  <li><a href="#predictores-categóricos" id="toc-predictores-categóricos" class="nav-link" data-scroll-target="#predictores-categóricos"><span class="header-section-number">7.6</span> Predictores Categóricos</a>
  <ul class="collapse">
  <li><a href="#pingüinos-categóricos" id="toc-pingüinos-categóricos" class="nav-link" data-scroll-target="#pingüinos-categóricos"><span class="header-section-number">7.6.1</span> Pingüinos Categóricos</a></li>
  <li><a href="#relación-con-modelos-jerárquicos" id="toc-relación-con-modelos-jerárquicos" class="nav-link" data-scroll-target="#relación-con-modelos-jerárquicos"><span class="header-section-number">7.6.2</span> Relación con modelos jerárquicos</a></li>
  </ul></li>
  <li><a href="#interacciones" id="toc-interacciones" class="nav-link" data-scroll-target="#interacciones"><span class="header-section-number">7.7</span> Interacciones</a></li>
  <li><a href="#interpretando-modelos-con-bambi" id="toc-interpretando-modelos-con-bambi" class="nav-link" data-scroll-target="#interpretando-modelos-con-bambi"><span class="header-section-number">7.8</span> Interpretando modelos con Bambi</a></li>
  <li><a href="#selección-de-variables" id="toc-selección-de-variables" class="nav-link" data-scroll-target="#selección-de-variables"><span class="header-section-number">7.9</span> Selección de Variables</a></li>
  <li><a href="#inferencia-predictiva-por-proyección" id="toc-inferencia-predictiva-por-proyección" class="nav-link" data-scroll-target="#inferencia-predictiva-por-proyección"><span class="header-section-number">7.10</span> Inferencia predictiva por proyección</a></li>
  <li><a href="#selección-de-variables-con-kulprit" id="toc-selección-de-variables-con-kulprit" class="nav-link" data-scroll-target="#selección-de-variables-con-kulprit"><span class="header-section-number">7.11</span> Selección de variables con Kulprit</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regresión lineal con Bambi</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>A good tool improves the way you work. A great tool improves the way you think. -Jeff Duntemann</p>
</blockquote>
<div id="cell-1" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> arviz <span class="im">as</span> az</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> bambi <span class="im">as</span> bmb</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> kulprit <span class="im">as</span> kpt</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>plt.style.use(<span class="st">'arviz-doc'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En el Capítulo anterior describimos los ingredientes básicos de los modelos de regresión lineal y cómo generalizarlos para que se ajusten mejor a nuestras necesidades. En este capítulo, seguiremos aprendiendo sobre modelos lineales, pero esta vez trabajaremos con <a href="https://bambinos.github.io/bambi/">Bambi</a>, una interfaz de construcción de modelos bayesianos de alto nivel escrita sobre PyMC. Bambi está diseñado para que sea extremadamente fácil ajustar modelos lineales, incluidos los jerárquicos. Veremos que el dominio de Bambi es en realidad más completo que los simples modelos lineales. En este capítulo vamos a aprender sobre:</p>
<ul>
<li>Cómo usar Bambi para construir y ajustar modelos</li>
<li>Cómo analizar resultados con Bambi</li>
<li>Regresión polinómica y splines</li>
<li>Modelos distributivos</li>
<li>Predictores categóricos</li>
<li>Interacciones</li>
<li>Selección de variables con Kulprit</li>
</ul>
<section id="una-sintaxis-para-gobernarlos-a-todos" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="una-sintaxis-para-gobernarlos-a-todos"><span class="header-section-number">7.1</span> Una sintaxis para gobernarlos a todos</h2>
<p>PyMC tiene una sintaxis muy simple y expresiva, que nos permite construir modelos arbitrarios, esta capacidad puede ser vista como una bendición, pero también como una carga. Bambi, en cambio, se centra en modelos de regresión; esta restricción conduce a una sintaxis más focalizada y características que serían difíciles de implementar en paquetes más generales.</p>
<p>Bambi utiliza una sintaxis de fórmula de Wilkinson similar a la utilizada por muchos paquetes de R como nlme, lme4 o brms. Supongamos que tenemos un DataFrame como el siguiente:</p>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a>SIZE <span class="op">=</span> <span class="dv">117</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>datos <span class="op">=</span> pd.DataFrame(</span>
<span id="cb3-3"><a href="#cb3-3"></a>    {</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="st">"y"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="st">"x"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="st">"z"</span>: np.random.normal(size<span class="op">=</span>SIZE),</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="st">"g"</span>: [<span class="st">"Group A"</span>, <span class="st">"Group B"</span>, <span class="st">"Group C"</span>] <span class="op">*</span> <span class="dv">39</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>    }</span>
<span id="cb3-9"><a href="#cb3-9"></a>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>datos.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">y</th>
<th data-quarto-table-cell-role="th">x</th>
<th data-quarto-table-cell-role="th">z</th>
<th data-quarto-table-cell-role="th">g</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.754899</td>
<td>-0.632978</td>
<td>1.127906</td>
<td>Group A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.430386</td>
<td>-0.311282</td>
<td>0.450401</td>
<td>Group B</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-1.439206</td>
<td>0.646127</td>
<td>-1.427421</td>
<td>Group C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.919614</td>
<td>-0.408645</td>
<td>-1.658352</td>
<td>Group A</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.617014</td>
<td>-0.930976</td>
<td>-0.090931</td>
<td>Group B</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Usando estos datos queremos construir un modelo lineal que prediga <code>y</code> a partir de <code>x</code>. Usando PyMC haríamos algo como:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> lm:</span>
<span id="cb4-2"><a href="#cb4-2"></a>    Intercept <span class="op">=</span> pm.Normal(<span class="st">"Intercept"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    x <span class="op">=</span> pm.Normal(<span class="st">"x"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    y_sigma <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma"</span>, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    y_mean <span class="op">=</span> Intercept <span class="op">+</span> x <span class="op">*</span> data[<span class="st">"x"</span>]</span>
<span id="cb4-6"><a href="#cb4-6"></a>    y <span class="op">=</span> pm.Normal(<span class="st">"y"</span>, y_mean, y_sigma, observed<span class="op">=</span>data[<span class="st">"y"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Usando la sintaxis de Bambi, podemos escribir el mismo modelo como:</p>
<div id="cell-7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>un_modelo <span class="op">=</span> bmb.Model(<span class="st">"y ~ x"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En el lado izquierdo de <code>~</code> tenemos la variable dependiente y en el lado derecho la(s) variable(s) independiente(s). Con esta sintaxis, solo estamos especificando la media (<span class="math inline">\(\mu\)</span> en el modelo <code>lm</code> de PyMC). De forma predeterminada, Bambi asume que el likelihood es una Normal. Esto se puede cambiar con el argumento <code>family</code>. Esta sintáxis solo especifica cómo se relacionan las variables dependientes e independiente, pero no especifica las distribuciones <em>a priori</em>. Bambi internamente define distribuciones a priori debilmente informativas. Al imprimir un modelo de Bambi obtenemos mucha información útil sobre su especificación.</p>
<div id="cell-9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>un_modelo</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>       Formula: y ~ x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            Intercept ~ Normal(mu: -0.0014, sigma: 2.3329)
            x ~ Normal(mu: 0.0, sigma: 2.4855)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 0.9325)</code></pre>
</div>
</div>
<p>La primera línea muestra la fórmula que usamos para definir el modelo y la segunda línea es el likelihood. En Bambi, usamos el argumento <code>family</code> para especificar el . La tercera línea es la función de enlace. Por defecto cada familia tiene asociada una función de enlace, por ej la Gaussiana se asocia a la función identidad. Luego tenemos el número de observaciones utilizadas para ajustar el modelo, y lo siguiente nos dice que estamos modelando linealmente el parámetro <span class="math inline">\(\mu\)</span> de la Gaussiana. Luego, en las siguientes líneas tenemos la estructura del modelo. La primera parte muestra los efectos de nivel común, en este caso, el intercepto y el coefficiente de regressión (la “pendiente”) asociado a <code>x</code>. En la segunda parte se muestran los parámetros auxiliares, es decir, todos los parámetros no modelados linealmente, en este caso, la desviación estándar.</p>
<p>Si querés omitir el intercepto, tenés dos opciones:</p>
<div id="cell-11" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>no_intercepto_1 <span class="op">=</span> bmb.Model(<span class="st">"y ~ 0 + x"</span>, datos)</span>
<span id="cb8-2"><a href="#cb8-2"></a>no_intercepto_1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>       Formula: y ~ 0 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.4855)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 0.9325)</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>no_intercepto_2 <span class="op">=</span> bmb.Model(<span class="st">"y ~ -1 + x"</span>, datos)</span>
<span id="cb10-2"><a href="#cb10-2"></a>no_intercepto_2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>       Formula: y ~ -1 + x
        Family: gaussian
          Link: mu = identity
  Observations: 117
        Priors: 
    target = mu
        Common-level effects
            x ~ Normal(mu: 0.0, sigma: 2.4855)
        
        Auxiliary parameters
            sigma ~ HalfStudentT(nu: 4.0, sigma: 0.9325)</code></pre>
</div>
</div>
<p>Con Bambi también podemos incluir efectos a nivel de grupo (es decir jerarquías), por ejemplo, si queremos usar la variable <code>g</code> para agrupar parcialmente las estimaciones de <code>x</code> podemos hacerlo así:</p>
<div id="cell-14" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>modelo_h <span class="op">=</span> bmb.Model(<span class="st">"y ~ x + z + (x | g)"</span>, datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para obtener una representación gráfica de la estructura de un modelo de Bambi podemos usar el método <code>.graph()</code>, esto requiere que previamente hayamos usado el método <code>.build()</code> para construir el modelo. O el método <code>.fit()</code> para ajustar el modelo (calcular la distribución posterior de los parámetros). Veamos como lucen <code>un_modelo</code> y <code>modelo_h</code>:</p>
<div id="cell-16" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>un_modelo.build()</span>
<span id="cb13-2"><a href="#cb13-2"></a>un_modelo.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-10-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>modelo_h.build()</span>
<span id="cb14-2"><a href="#cb14-2"></a>modelo_h.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-11-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La sintaxis de la fórmula es muy simple, pero también muy poderosa. Acabamos de arañar la superficie de lo que podemos hacer con él. En lugar de describir la sintaxis de una vez, la mostraremos mediante ejemplos. Así que comencemos ajustando el modelo de bicicleta del capítulo anterior.</p>
</section>
<section id="bicicletas-bambinas" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="bicicletas-bambinas"><span class="header-section-number">7.2</span> Bicicletas bambinas</h2>
<div id="cell-20" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>bicis <span class="op">=</span> pd.read_csv(<span class="st">"datos/bicis.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>modelo_t <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura"</span>, bicis, family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>idata_t <span class="op">=</span> modelo_t.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1072fe79bb044ceca57492776b2cc839","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>modelo_t.graph()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora vamos a graficar el ajuste medio a posteriori y las predicciones. Para ello usaremos la función <code>plot_predictions</code> del módulo <code>interpret</code>.</p>
<div id="cell-24" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>)) </span>
<span id="cb19-2"><a href="#cb19-2"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb19-3"><a href="#cb19-3"></a>bmb.interpret.plot_predictions(modelo_t, idata_t, <span class="st">"temperatura"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a>axes[<span class="dv">0</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>,  zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a>axes[<span class="dv">1</span>].plot(bicis.temperatura, bicis.alquiladas, <span class="st">"."</span>, color<span class="op">=</span><span class="st">"0.5"</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb19-7"><a href="#cb19-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb19-8"><a href="#cb19-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Probemos ahora ajustar un modelo de regresión con dos variables predictoras, <code>temperatura</code> y <code>humedad</code>.</p>
<div id="cell-26" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>modelo_th <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ temperatura + humedad"</span>, bicis, </span>
<span id="cb20-2"><a href="#cb20-2"></a>                     family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>                     </span>
<span id="cb20-4"><a href="#cb20-4"></a>idata_th <span class="op">=</span> modelo_th.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, temperatura, humedad]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"701a63ba2f644dbcbc888051e362c3fb","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>bmb.interpret.plot_predictions(modelo_th, idata_th, [<span class="st">"temperatura"</span>, <span class="st">"humedad"</span>],</span>
<span id="cb22-2"><a href="#cb22-2"></a>                               subplot_kwargs<span class="op">=</span>{<span class="st">"group"</span>:<span class="va">None</span>, <span class="st">"panel"</span>:<span class="st">"humedad"</span>},</span>
<span id="cb22-3"><a href="#cb22-3"></a>                               legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb22-4"><a href="#cb22-4"></a>                               fig_kwargs<span class="op">=</span>{<span class="st">"sharey"</span>:<span class="va">True</span>, <span class="st">"sharex"</span>:<span class="va">True</span>})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/pymc/lib/python3.11/site-packages/bambi/interpret/utils.py:383: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if is_string_dtype(x) or is_categorical_dtype(x):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En la figura anterior podemos ver que la temperatura tiene un efecto positivo en el número de bicicletas alquiladas, mientras que la humedad tiene un efecto negativo. También podemos ver que el efecto de la temperatura es más fuerte que el de la humedad.</p>
</section>
<section id="regresión-polinomial" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="regresión-polinomial"><span class="header-section-number">7.3</span> Regresión polinomial</h2>
<p>Una forma de ajustar curvas usando un modelo de regresión lineal es construyendo un polinomio, como este:</p>
<p><span class="math display">\[
   \mu = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \beta_4 x^4 \dots \beta_m x^m
\]</span></p>
<p>donde <span class="math inline">\(m\)</span> es el grado del polinomio.</p>
<p>Hay dos cosas importantes a tener en cuenta. Primero, la regresión polinómica sigue siendo una regresión lineal; la linealidad se refiere a los coeficientes (los <span class="math inline">\(\beta\)</span>s), no a las variables (los <span class="math inline">\(x\)</span>s). La segunda es que simplemente estamos creando nuevas variables de la nada. La única variable observada es , el resto son sólo potencias de . Crear nuevas variables a partir de las observadas es un “truco” perfectamente válido al hacer regresión, a veces la transformación puede estar motivada o justificada por la teoría (como sacar la raíz cuadrada de la longitud de los bebés), pero a veces es solo una forma de ajustar una curva. La intuición con los polinomios es que para un valor dado de , cuanto mayor sea el grado del polinomio, más flexible será el ajuste. Un polinomio de grado 1 es una línea, un polinomio de grado 2 es una curva que puede subir o bajar, un polinomio de grado 3 es una curva que puede subir y luego bajar (o al revés), y así sucesivamente. Note que dije “puede” porque si tenemos un polinomio de grado 3 como <span class="math inline">\(\beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3\)</span> pero los coeficientes <span class="math inline">\(\beta_2\)</span> y <span class="math inline">\(\beta_3\)</span> son 0 (o prácticamente 0), entonces la curva será una línea.</p>
<p>Hay dos formas de definir una regresión polinómica con Bambi. Podemos escribir los polinomios <em>brutos</em>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">"y ~ x + I(x ** 2) + I(x ** 3) + I(x ** 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>donde usamos la función de identidad <code>I</code> para dejar claro que queremos elevar <span class="math inline">\(x\)</span> a alguna potencia. Necesitamos esto porque el operador <code>**</code> tiene un significado especial para Bambi. Si usamos esta sintaxis, le estamos diciendo a Bambi que modele la media de <span class="math inline">\(y\)</span> como <span class="math inline">\(\alpha + \beta_0 x + \beta_0 x^2 + \beta_0 x^3 + \beta_0 x^4\)</span></p>
<p>Alternativamente podemos escribir</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">"y ~ poly(x, 4)"</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Esto también generará un polinomio de grado 4, pero los términos del polinomio serán ortogonales entre sí, lo que significa que la correlación entre los términos se reduce. Sin entrar en detalles matemáticos, esto tiene al menos dos consecuencias importantes con respecto a los polinomios <em>brutos</em>. En primer lugar, la estimación puede ser numéricamente más estable y, en segundo lugar, la interpretación de los coeficientes es diferente. En la regresión polinómica <em>estándar</em>, los coeficientes pueden ser difíciles de interpretar, ya que cambiar el valor de un coeficiente afecta a todo el polinomio. En cambio, los polinomios ortogonales permiten interpretar más claramente el efecto de cada término, ya que son independientes entre sí. Si bien la interpretación de los coeficientes es diferente, otros resultados siguen siendo los mismos. Por ejemplo, deberías obtener las mismas predicciones con ambos enfoques.</p>
<p>Construyamos un polinomio ortogonal de grado 4 para modelar los datos de la bicis. Para este ejemplo, usaremos la variable <code>hora</code>:</p>
<div id="cell-31" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>modelo_poly4 <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ poly(hora, degree=4)"</span>, bicis,</span>
<span id="cb26-2"><a href="#cb26-2"></a>                       family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>idata_poly4 <span class="op">=</span> modelo_poly4.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, poly(hora, degree=4)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"72b6edd48dd74ac687c7efc9a676f0b2","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>)) </span>
<span id="cb28-2"><a href="#cb28-2"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb28-3"><a href="#cb28-3"></a>bmb.interpret.plot_predictions(modelo_poly4, idata_poly4, <span class="st">"hora"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="cf">for</span> ax <span class="kw">in</span> axes.ravel():</span>
<span id="cb28-6"><a href="#cb28-6"></a>    ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"media"</span>)</span>
<span id="cb28-8"><a href="#cb28-8"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"predicciones"</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">""</span>)</span>
<span id="cb28-10"><a href="#cb28-10"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">""</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Text(0, 0.5, '')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-19-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Un problema con los polinomios es que actúan <em>globalmente</em>. Cuando aplicamos un polinomio de grado <span class="math inline">\(m\)</span> estamos diciendo que la relación entre las variables independientes y dependientes es de grado <span class="math inline">\(m\)</span> para todo el conjunto de datos. Esto puede resultar problemático cuando diferentes regiones de nuestros datos necesitan diferentes niveles de flexibilidad. Esto podría conducir, por ejemplo, a curvas demasiado flexibles. A medida que aumenta el grado, el ajuste se vuelve más sensible a la eliminación de puntos o, de manera equivalente, a la adición de datos futuros. En otras palabras, a medida que aumenta el grado, el modelo se vuelve más propenso a sobreajustarse. La regresión polinomial Bayesiana generalmente sufre menos de este “exceso” gracias al uso de priors y al cálculo de toda una distribución a posteriori y no una estimación puntual.</p>
</section>
<section id="splines" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="splines"><span class="header-section-number">7.4</span> Splines</h2>
<p>Una forma general de escribir modelos muy flexibles es aplicar funciones <span class="math inline">\(B_{m}\)</span> a <span class="math inline">\(X_{m}\)</span> y luego multiplicarlas por coeficientes <span class="math inline">\(\beta_m\)</span>:</p>
<p><span class="math display">\[
\mu = \beta_0 + \beta_1 B_{1}(X_{1}) + \beta_2 B_{2}(X_{2}) + \cdots + \beta_m B_{m}(X_{m})
\]</span></p>
<p>Somos libres de elegir las funciones <span class="math inline">\(B_{m}\)</span>, por ejemplo, podemos elegir polinomios. Una opción popular es usar B-splines, no vamos a discutir su definición, pero podemos pensar en ellos como una forma de crear curvas suaves de tal manera que obtengamos flexibilidad, como con los polinomios, pero menos propensos al sobreajuste. Los B-splines son polinomios por partes, es decir, polinomios que están restringidos a afectar solo una parte de los datos. La siguiente figura muestra 3 ejemplos de polinomios por partes de grado creciente. Las líneas verticales punteadas muestran los “nudos”, que son los puntos utilizados para restringir las regiones, la línea gris discontinua representa la función que queremos aproximar y las líneas negras son los polinomios por partes.</p>
<p><img src="img/piecewise.png" class="img-fluid"></p>
<p>La siguiente figura muestra ejemplos de splines de grado 1 y 3, los puntos en la parte inferior representan los nudos y las líneas discontinuas son los B-splines. En la parte superior tenemos todos los B-splines con igual peso, usamos una escala de grises para resaltar que tenemos muchos B-splines. En el panel inferior, cada B-splines tiene un peso diferente (los multiplicamos por coeficientes <span class="math inline">\(\beta_m\)</span>), si sumamos los B-splines ponderados obtenemos como resultado la línea negra. Esta línea negra es lo que solemos llamar “la spline”. Podemos utilizar la estadística Bayesiana para encontrar los pesos adecuados para los B-splines.</p>
<p><img src="img/splines_weighted.png" class="img-fluid"></p>
<p>Podemos usar B-splines con Bambi usando la función <code>bs</code>. Por ejemplo, ajustemos un spline de grado 3 a los datos de las bicis:</p>
<div id="cell-35" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>num_knots <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>knots <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">23</span>, num_knots<span class="op">+</span><span class="dv">2</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb30-3"><a href="#cb30-3"></a>modelo_spline <span class="op">=</span> bmb.Model(<span class="st">"alquiladas ~ bs(hora, degree=3, knots=knots)"</span>, bicis,           </span>
<span id="cb30-4"><a href="#cb30-4"></a>                         family<span class="op">=</span><span class="st">"negativebinomial"</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>idata_spline <span class="op">=</span> modelo_spline.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [alquiladas_alpha, Intercept, bs(hora, degree=3, knots=knots)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 4 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"fc9c0e2a68554e83b84c64235dde7683","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la siguiente figura podemos ver que el número de bicicletas de alquiler es el más bajo a altas horas de la noche. Luego se produce un aumento, probablemente cuando la gente se despierta y va al trabajo, a la escuela u otras actividades. Tenemos un primer pico alrededor de la hora 8, luego un ligero descenso, seguido por el segundo pico alrededor de la hora 18, probablemente porque la gente regresa a casa, después del cual hay un descenso constante. Observe que la curva no es muy suave, esto se debe a que los datos están discretizados (por hora).</p>
<div id="cell-37" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb32-2"><a href="#cb32-2"></a>bmb.interpret.plot_predictions(modelo_spline, idata_spline, <span class="st">"hora"</span>, ax<span class="op">=</span>ax)</span>
<span id="cb32-3"><a href="#cb32-3"></a>ax.plot(bicis.hora, bicis.alquiladas, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Cuando trabajamos con splines, una decisión importante es determinar el número y la ubicación de los nudos. Esto puede ser una tarea algo desalentadora ya que el número óptimo de nudos y su espaciado no son evidentes de inmediato. Una sugerencia útil para determinar las ubicaciones de los nudos es considerar colocarlos según cuantiles en lugar de hacerlo de manera uniforme. Por ejemplo <code>nudos = np.quantile(bicis.hora, np.linspace(0, 1, num_knots))</code>. Al hacerlo, colocaríamos más nudos en áreas donde tenemos una mayor cantidad de datos, y menos nudos en áreas con menos datos. Esto da como resultado una aproximación más adaptable que captura efectivamente la variabilidad en regiones con una mayor densidad de puntos de datos. Además, es posible que deseemos ajustar splines con distintos números de nudos y posiciones y luego evaluar los resultados, utilizando herramientas como LOO, como veremos en el próximo capítulo.</p>
</section>
<section id="modelos-distribucionales" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="modelos-distribucionales"><span class="header-section-number">7.5</span> Modelos distribucionales</h2>
<p>Anteriormente vimos que podemos usar modelos lineales para parámetros distintos de la media. Por ejemplo, podemos utilizar un modelo lineal para la media y un modelo lineal para la desviación estándar de una distribución Gaussiana. Estos modelos suelen denominarse modelos distribucionales. La sintaxis de Bambi para los modelos distribucionales es muy similar, sólo necesitamos agregar una línea para los parámetros auxiliares que queremos modelar. Por ejemplo, sigma para una Gaussiano o alfa para un NegativaBinomial</p>
<p>Reproduzcamos ahora un ejemplo del capítulo anterior, el ejemplo de los bebés.</p>
<div id="cell-40" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a>bebes <span class="op">=</span> pd.read_csv(<span class="st">'datos/babies.csv'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-41" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>modelo_cons <span class="op">=</span> bmb.Model(<span class="st">"Longitud ~ np.sqrt(Meses)"</span>, bebes)</span>
<span id="cb34-2"><a href="#cb34-2"></a>idata_cons <span class="op">=</span> modelo_cons.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Longitud_sigma, Intercept, np.sqrt(Meses)]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"21e8ab403b4a47f18fd9266a0accec46","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En el modelo anterior sigma es constante, ahora veamos un modelo distribucional. En este modelo <code>sigma</code> es una función lineal de <code>Meses</code>.</p>
<div id="cell-43" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>formula <span class="op">=</span> bmb.Formula(</span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="st">"Longitud ~ np.sqrt(Meses)"</span>,</span>
<span id="cb36-3"><a href="#cb36-3"></a>    <span class="st">"sigma ~ Meses"</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>modelo_dis <span class="op">=</span> bmb.Model(formula, bebes)</span>
<span id="cb36-6"><a href="#cb36-6"></a>idata_dis <span class="op">=</span> modelo_dis.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [Intercept, np.sqrt(Meses), sigma_Intercept, sigma_Meses]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"1b551c5c497d427d9b9efbdae97f2c47","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la siguiente figura podemos ver los valores a posteriori de sigma para los modelos con sigma constante y variable. Podemos ver que cuando se permite que sigma varíe obtenemos valores por debajo y por encima de la estimación para un sigma constante, lo que significa que estamos subestimando y sobreestimando este parámetro cuando no permitimos que cambie.</p>
<div id="cell-45" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="cf">for</span> idx <span class="kw">in</span> idata_dis.posterior.coords.get(<span class="st">"Longitud_obs"</span>):</span>
<span id="cb38-5"><a href="#cb38-5"></a>    values <span class="op">=</span> idata_dis.posterior[<span class="st">"sigma"</span>].sel(Longitud_obs<span class="op">=</span>idx).to_numpy().flatten()</span>
<span id="cb38-6"><a href="#cb38-6"></a>    grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb38-7"><a href="#cb38-7"></a>    ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">"C1"</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a></span>
<span id="cb38-9"><a href="#cb38-9"></a>values <span class="op">=</span> idata_cons.posterior[<span class="st">"Longitud_sigma"</span>].to_numpy().flatten()</span>
<span id="cb38-10"><a href="#cb38-10"></a>grid, pdf <span class="op">=</span> az.kde(values)</span>
<span id="cb38-11"><a href="#cb38-11"></a>ax.plot(grid, pdf, lw<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a></span>
<span id="cb38-13"><a href="#cb38-13"></a>handles <span class="op">=</span> [</span>
<span id="cb38-14"><a href="#cb38-14"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma variable"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"k"</span>, alpha<span class="op">=</span><span class="fl">0.6</span>),</span>
<span id="cb38-15"><a href="#cb38-15"></a>    Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], label<span class="op">=</span><span class="st">"sigma constante"</span>, lw<span class="op">=</span><span class="fl">1.5</span>, color<span class="op">=</span><span class="st">"C0"</span>)</span>
<span id="cb38-16"><a href="#cb38-16"></a>]</span>
<span id="cb38-17"><a href="#cb38-17"></a></span>
<span id="cb38-18"><a href="#cb38-18"></a>legend <span class="op">=</span> ax.legend(handles<span class="op">=</span>handles, loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb38-19"><a href="#cb38-19"></a></span>
<span id="cb38-20"><a href="#cb38-20"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">"Alfa a posteriori"</span>, yticks<span class="op">=</span>[])<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La siguiente figura muestra el ajuste a posteriori para <code>model_dis</code>. Observe que el modelo puede capturar el aumento de la variabilidad a medida que los bebés crecen.</p>
<div id="cell-47" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>_, ax <span class="op">=</span> plt.subplots(sharey<span class="op">=</span><span class="va">True</span>, sharex<span class="op">=</span><span class="st">"col"</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>)) </span>
<span id="cb39-2"><a href="#cb39-2"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, ax<span class="op">=</span>ax, fig_kwargs<span class="op">=</span>{<span class="st">"color"</span>:<span class="st">"k"</span>})</span>
<span id="cb39-3"><a href="#cb39-3"></a>bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax)</span>
<span id="cb39-4"><a href="#cb39-4"></a>ax_ <span class="op">=</span> bmb.interpret.plot_predictions(modelo_dis, idata_dis, <span class="st">"Meses"</span>, pps<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax, prob<span class="op">=</span><span class="fl">0.65</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>ax_[<span class="dv">1</span>][<span class="dv">0</span>].get_children()[<span class="dv">5</span>].set_facecolor(<span class="st">'C1'</span>)  </span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a>ax.plot(bebes.Meses, bebes.Longitud, <span class="st">"C2."</span>, zorder<span class="op">=-</span><span class="dv">3</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Al trabajar con PyMC vimos que el muestreo de la distribución predictiva a posteriori, evaluado en valores no observados, requiere que definamos el modelo con las “X” como <code>Mutable_data</code> y luego actualicemos el valor de la variable mutable antes de calcular la distribución predictiva posterior. Con Bambi esto no es necesario, podemos usar el método <code>predict</code> para predecir nuevos valores pasando los nuevos valores al argumento <code>data</code>. Por ejemplo, predigamos la longitud de un bebé a los 0,5 meses (15 días):</p>
<div id="cell-49" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>modelo_dis.predict(idata_dis, kind<span class="op">=</span><span class="st">"pps"</span>, data<span class="op">=</span>pd.DataFrame({<span class="st">"Meses"</span>:[<span class="fl">0.5</span>]}))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto agrega un grupo <code>posterior_predictive</code> a <code>idata_dis</code></p>
<div id="cell-51" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>idata_dis</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

            <div>
              <div class="xr-header">
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class="xr-section-item">
                  <input id="idata_posterior44e93f8a-c88a-46d9-be57-e72d46b70fee" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior44e93f8a-c88a-46d9-be57-e72d46b70fee" class="xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:          (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain            (chain) int64 0 1 2 3
  * draw             (draw) int64 0 1 2 3 4 5 6 ... 993 994 995 996 997 998 999
  * Longitud_obs     (Longitud_obs) int64 0
Data variables:
    Intercept        (chain, draw) float64 48.44 48.44 48.36 ... 48.39 48.0
    np.sqrt(Meses)   (chain, draw) float64 7.697 7.697 7.74 ... 7.8 7.786 7.805
    sigma_Intercept  (chain, draw) float64 0.8343 0.8343 0.8914 ... 0.808 0.8874
    sigma_Meses      (chain, draw) float64 0.03451 0.03451 ... 0.03537 0.03419
    Longitud_mean    (chain, draw, Longitud_obs) float64 53.89 53.89 ... 53.52
    Longitud_sigma   (chain, draw, Longitud_obs) float64 2.343 2.343 ... 2.471
Attributes:
    created_at:                  2024-06-05T18:21:11.098236+00:00
    arviz_version:               0.19.0.dev0
    inference_library:           pymc
    inference_library_version:   5.15.1
    sampling_time:               3.078589677810669
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-6660ea04-14ce-4c5f-96e1-ed01d322fd9c" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-6660ea04-14ce-4c5f-96e1-ed01d322fd9c" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-6c2c2a97-69e7-4d57-a5f3-2899bf99b2f3" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-6c2c2a97-69e7-4d57-a5f3-2899bf99b2f3" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-661ad4d1-8aa4-41af-8d70-21a33a5bd8b2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-661ad4d1-8aa4-41af-8d70-21a33a5bd8b2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-222fc180-9b01-42f5-92e1-506b7c7f3145" class="xr-var-data-in" type="checkbox"><label for="data-222fc180-9b01-42f5-92e1-506b7c7f3145" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-3f43e17f-593a-4022-a1e6-91e9c7d41f00" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3f43e17f-593a-4022-a1e6-91e9c7d41f00" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c5e48796-92d5-4bca-9199-73e158df7e78" class="xr-var-data-in" type="checkbox"><label for="data-c5e48796-92d5-4bca-9199-73e158df7e78" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-5e896fd7-da98-4474-ba04-211329dbc4a3" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-5e896fd7-da98-4474-ba04-211329dbc4a3" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d7ff25c6-68aa-41ff-8bb2-186a827fd7ae" class="xr-var-data-in" type="checkbox"><label for="data-d7ff25c6-68aa-41ff-8bb2-186a827fd7ae" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-e1a60526-aaba-48fa-bb3b-71e63a999f98" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-e1a60526-aaba-48fa-bb3b-71e63a999f98" class="xr-section-summary">Data variables: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">48.44 48.44 48.36 ... 48.39 48.0</div><input id="attrs-21521ae0-d061-4a69-90b0-af1a7e8e1475" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-21521ae0-d061-4a69-90b0-af1a7e8e1475" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-da528fc5-5d74-4616-9313-6b772a9846ea" class="xr-var-data-in" type="checkbox"><label for="data-da528fc5-5d74-4616-9313-6b772a9846ea" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[48.44293368, 48.44293368, 48.36039184, ..., 48.27682431,
        48.02375781, 48.48783755],
       [48.11187103, 47.7256746 , 48.14707988, ..., 47.81390197,
        47.80847726, 47.75665644],
       [47.73471442, 47.88412742, 47.99550077, ..., 48.07249159,
        47.98683426, 48.02668406],
       [48.16876678, 48.11500324, 47.84851193, ..., 48.28145512,
        48.39490346, 48.00230026]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>np.sqrt(Meses)</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">7.697 7.697 7.74 ... 7.786 7.805</div><input id="attrs-53ae7b00-92cc-4150-841e-a020bcfd0493" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-53ae7b00-92cc-4150-841e-a020bcfd0493" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5c294d11-7615-4528-ad81-2720aaa9c193" class="xr-var-data-in" type="checkbox"><label for="data-5c294d11-7615-4528-ad81-2720aaa9c193" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[7.69656065, 7.69656065, 7.7400628 , ..., 7.77157731, 7.79544571,
        7.65576051],
       [7.82852268, 7.9919875 , 7.82503509, ..., 7.93262145, 8.00758962,
        7.97253799],
       [7.97224438, 7.99326531, 7.82267111, ..., 7.86107407, 7.88660552,
        7.8884398 ],
       [7.8139373 , 7.84931745, 7.94983312, ..., 7.79963224, 7.78642727,
        7.80532478]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Intercept</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.8343 0.8343 ... 0.808 0.8874</div><input id="attrs-ce4251f6-404a-43c0-a9db-fe4119da5c4e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ce4251f6-404a-43c0-a9db-fe4119da5c4e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-000b8f3d-f1d8-4e38-a1da-c978ab30048e" class="xr-var-data-in" type="checkbox"><label for="data-000b8f3d-f1d8-4e38-a1da-c978ab30048e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.83432278, 0.83432278, 0.89142131, ..., 0.83996461, 0.92322135,
        0.83152889],
       [0.8616674 , 0.82137011, 0.84346199, ..., 0.89369876, 0.93395968,
        0.81059174],
       [0.83594799, 0.8722287 , 0.82357709, ..., 0.95442163, 0.77021651,
        0.94390128],
       [0.78731921, 0.82930343, 0.84564086, ..., 0.83751167, 0.80798124,
        0.88739966]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>sigma_Meses</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.03451 0.03451 ... 0.03537 0.03419</div><input id="attrs-c9f2adc7-1126-49bb-bbd0-064231aec737" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c9f2adc7-1126-49bb-bbd0-064231aec737" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-24c5955a-66e1-43db-8e98-05a359cbd82a" class="xr-var-data-in" type="checkbox"><label for="data-24c5955a-66e1-43db-8e98-05a359cbd82a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.03450583, 0.03450583, 0.03361624, ..., 0.03324357, 0.03327298,
        0.03582484],
       [0.03368295, 0.03367979, 0.03392756, ..., 0.03186976, 0.03225318,
        0.03356651],
       [0.03379542, 0.03254186, 0.0336443 , ..., 0.02928198, 0.03828739,
        0.02711679],
       [0.03687392, 0.03591957, 0.03113851, ..., 0.03474482, 0.03536545,
        0.03418826]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_mean</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">53.89 53.89 53.83 ... 53.9 53.52</div><input id="attrs-0eabc453-4b7b-4613-8085-a33f23bc40df" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0eabc453-4b7b-4613-8085-a33f23bc40df" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9ea19151-2e64-42fc-a2f2-286313f95a54" class="xr-var-data-in" type="checkbox"><label for="data-9ea19151-2e64-42fc-a2f2-286313f95a54" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[53.88522391],
        [53.88522391],
        [53.83344274],
        ...,
        [53.77215932],
        [53.53597033],
        [53.90127772]],

       [[53.6474725 ],
        [53.37686316],
        [53.68021526],
        ...,
        [53.42311238],
        [53.47069818],
        [53.39409211]],

       [[53.37194247],
        [53.53621953],
        [53.52696456],
        ...,
        [53.63111037],
        [53.56350651],
        [53.60465334]],

       [[53.69405484],
        [53.66530884],
        [53.46989284],
        ...,
        [53.79662797],
        [53.90073898],
        [53.52149834]]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>Longitud_sigma</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.343 2.343 2.48 ... 2.283 2.471</div><input id="attrs-ca114c0e-08bc-4613-bc0f-50c5950dc441" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ca114c0e-08bc-4613-bc0f-50c5950dc441" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-06cc4b79-f01a-4226-b6d1-222cb6e45bcd" class="xr-var-data-in" type="checkbox"><label for="data-06cc4b79-f01a-4226-b6d1-222cb6e45bcd" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[2.34333634],
        [2.34333634],
        [2.47992775],
        ...,
        [2.35510753],
        [2.55961752],
        [2.33834008]],

       [[2.40730743],
        [2.3122244 ],
        [2.36416706],
        ...,
        [2.48341255],
        [2.58593275],
        [2.28730667]],

       [[2.34631427],
        [2.4314788 ],
        [2.31729194],
        ...,
        [2.63547287],
        [2.20198716],
        [2.60507034]],

       [[2.23838846],
        [2.33325251],
        [2.36602212],
        ...,
        [2.35110183],
        [2.28339636],
        [2.47068092]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-517080e5-6bae-487b-b076-bcdaf4d49a28" class="xr-section-summary-in" type="checkbox"><label for="section-517080e5-6bae-487b-b076-bcdaf4d49a28" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-f910a9f0-b328-4983-aa14-76dff9e94e16" class="xr-index-data-in" type="checkbox"><label for="index-f910a9f0-b328-4983-aa14-76dff9e94e16" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-6150125f-9202-4f4a-88d8-9688e931321d" class="xr-index-data-in" type="checkbox"><label for="index-6150125f-9202-4f4a-88d8-9688e931321d" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-3778a27b-c48e-482e-bc2f-a71cc7362c96" class="xr-index-data-in" type="checkbox"><label for="index-3778a27b-c48e-482e-bc2f-a71cc7362c96" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-5892a9c6-19a3-4033-b5ff-a8954e834a77" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-5892a9c6-19a3-4033-b5ff-a8954e834a77" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-06-05T18:21:11.098236+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0.dev0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>3.078589677810669</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_posterior_predictive724cc344-6e18-4d9c-9838-bef720911219" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posterior_predictive724cc344-6e18-4d9c-9838-bef720911219" class="xr-section-summary">posterior_predictive</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (chain: 4, draw: 1000, Longitud_obs: 1)
Coordinates:
  * chain         (chain) int64 0 1 2 3
  * draw          (draw) int64 0 1 2 3 4 5 6 7 ... 993 994 995 996 997 998 999
  * Longitud_obs  (Longitud_obs) int64 0
Data variables:
    Longitud      (chain, draw, Longitud_obs) float64 52.17 52.06 ... 57.27 48.1
Attributes:
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-130f77af-f9ac-499c-a923-c3491a776948" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-130f77af-f9ac-499c-a923-c3491a776948" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li><li><span class="xr-has-index">Longitud_obs</span>: 1</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-da8b98f4-b006-4624-88c5-6ba4fd729348" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-da8b98f4-b006-4624-88c5-6ba4fd729348" class="xr-section-summary">Coordinates: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-0ee68ae1-84e7-43ce-9521-89c5cf42c9e0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0ee68ae1-84e7-43ce-9521-89c5cf42c9e0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6c940f83-abec-4d1d-bbfa-e81251b2d28e" class="xr-var-data-in" type="checkbox"><label for="data-6c940f83-abec-4d1d-bbfa-e81251b2d28e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-e8b62b3c-86cd-4170-be3b-c4ec515d035f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e8b62b3c-86cd-4170-be3b-c4ec515d035f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5c812810-e978-44c4-bc45-6af89e42930b" class="xr-var-data-in" type="checkbox"><label for="data-5c812810-e978-44c4-bc45-6af89e42930b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-eb58a351-3fae-4fe9-8ad9-8ddbe818d4d6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-eb58a351-3fae-4fe9-8ad9-8ddbe818d4d6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-ad0ca353-f15b-4ce8-9d8b-d194bc0308f5" class="xr-var-data-in" type="checkbox"><label for="data-ad0ca353-f15b-4ce8-9d8b-d194bc0308f5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-ca5a72e7-78d9-4309-94c6-058ece221335" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-ca5a72e7-78d9-4309-94c6-058ece221335" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(chain, draw, Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">52.17 52.06 51.24 ... 57.27 48.1</div><input id="attrs-e8ef1e8d-1dad-4ae7-914b-91c70d616247" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e8ef1e8d-1dad-4ae7-914b-91c70d616247" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-43a847d5-de12-4a60-ae50-c86351bb8389" class="xr-var-data-in" type="checkbox"><label for="data-43a847d5-de12-4a60-ae50-c86351bb8389" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[[52.16742413],
        [52.05695854],
        [51.24251147],
        ...,
        [51.43823928],
        [51.992515  ],
        [52.86269241]],

       [[46.99460036],
        [52.66624866],
        [54.73354292],
        ...,
        [49.77116369],
        [54.82759178],
        [47.92800991]],

       [[54.19423851],
        [53.62918757],
        [52.09729938],
        ...,
        [51.87768525],
        [55.43204583],
        [51.5494679 ]],

       [[54.65772582],
        [55.87492211],
        [56.53158018],
        ...,
        [54.27311397],
        [57.2660512 ],
        [48.09801786]]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-df34dc03-c4fd-4f4e-a8fb-28c5b9265282" class="xr-section-summary-in" type="checkbox"><label for="section-df34dc03-c4fd-4f4e-a8fb-28c5b9265282" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-017ee8b7-8031-440b-b803-91801cc1f865" class="xr-index-data-in" type="checkbox"><label for="index-017ee8b7-8031-440b-b803-91801cc1f865" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-19e8042a-b55d-47f6-8697-ab9e422efb49" class="xr-index-data-in" type="checkbox"><label for="index-19e8042a-b55d-47f6-8697-ab9e422efb49" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-2e932049-b008-4759-90a7-5e5fa11446ec" class="xr-index-data-in" type="checkbox"><label for="index-2e932049-b008-4759-90a7-5e5fa11446ec" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0], dtype='int64', name='Longitud_obs'))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-a58fe3e3-85cd-4584-bef7-d3d43ffaf5c7" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-a58fe3e3-85cd-4584-bef7-d3d43ffaf5c7" class="xr-section-summary">Attributes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_sample_stats718e9490-da5d-4839-aca4-bc3a2c4ef007" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_stats718e9490-da5d-4839-aca4-bc3a2c4ef007" class="xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:                (chain: 4, draw: 1000)
Coordinates:
  * chain                  (chain) int64 0 1 2 3
  * draw                   (draw) int64 0 1 2 3 4 5 ... 994 995 996 997 998 999
Data variables: (12/17)
    acceptance_rate        (chain, draw) float64 0.9999 0.5393 ... 0.7002 0.9405
    diverging              (chain, draw) bool False False False ... False False
    energy                 (chain, draw) float64 2.129e+03 ... 2.13e+03
    energy_error           (chain, draw) float64 -0.1638 0.0 ... 0.536 -0.209
    index_in_trajectory    (chain, draw) int64 2 0 1 -3 0 1 1 ... 1 -2 -5 2 -1 2
    largest_eigval         (chain, draw) float64 nan nan nan nan ... nan nan nan
    ...                     ...
    process_time_diff      (chain, draw) float64 0.0004697 ... 0.0005636
    reached_max_treedepth  (chain, draw) bool False False False ... False False
    smallest_eigval        (chain, draw) float64 nan nan nan nan ... nan nan nan
    step_size              (chain, draw) float64 0.8525 0.8525 ... 1.136 1.136
    step_size_bar          (chain, draw) float64 0.9132 0.9132 ... 0.8944 0.8944
    tree_depth             (chain, draw) int64 2 3 3 2 1 2 2 2 ... 2 2 3 3 2 2 2
Attributes:
    created_at:                  2024-06-05T18:21:11.107541+00:00
    arviz_version:               0.19.0.dev0
    inference_library:           pymc
    inference_library_version:   5.15.1
    sampling_time:               3.078589677810669
    tuning_steps:                1000
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-f56a8c33-644e-4d78-9397-1163815ef521" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-f56a8c33-644e-4d78-9397-1163815ef521" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">chain</span>: 4</li><li><span class="xr-has-index">draw</span>: 1000</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-280bef20-eea5-4b4d-a294-d55e0f74f9a7" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-280bef20-eea5-4b4d-a294-d55e0f74f9a7" class="xr-section-summary">Coordinates: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">chain</span></div><div class="xr-var-dims">(chain)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3</div><input id="attrs-2e91b07a-2050-4020-9d64-9bf27ec36f8a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2e91b07a-2050-4020-9d64-9bf27ec36f8a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-68f0b51a-f03b-42e2-8654-236a54b42520" class="xr-var-data-in" type="checkbox"><label for="data-68f0b51a-f03b-42e2-8654-236a54b42520" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([0, 1, 2, 3])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">draw</span></div><div class="xr-var-dims">(draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 995 996 997 998 999</div><input id="attrs-1aebff7c-6d17-41cc-886b-4690be7df8a2" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-1aebff7c-6d17-41cc-886b-4690be7df8a2" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9d9c2edc-e3f7-4e6c-9ef2-ecca71744aef" class="xr-var-data-in" type="checkbox"><label for="data-9d9c2edc-e3f7-4e6c-9ef2-ecca71744aef" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 997, 998, 999])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-7cb9bb57-feaf-4b39-b628-adc584071977" class="xr-section-summary-in" type="checkbox"><label for="section-7cb9bb57-feaf-4b39-b628-adc584071977" class="xr-section-summary">Data variables: <span>(17)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>acceptance_rate</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9999 0.5393 ... 0.7002 0.9405</div><input id="attrs-f3e631ce-bf07-4b3b-ac12-cbec3f17d246" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f3e631ce-bf07-4b3b-ac12-cbec3f17d246" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-f55f906d-d106-408a-9a0d-1e608c8e4f42" class="xr-var-data-in" type="checkbox"><label for="data-f55f906d-d106-408a-9a0d-1e608c8e4f42" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.99986304, 0.53925713, 0.94078698, ..., 0.94260797, 0.61384011,
        0.8628982 ],
       [1.        , 0.64555551, 1.        , ..., 0.81066672, 0.64543934,
        0.94697239],
       [1.        , 0.56886998, 1.        , ..., 1.        , 0.93784845,
        0.79072915],
       [0.9625825 , 1.        , 0.83325665, ..., 0.90347303, 0.70024344,
        0.94049658]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>diverging</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-94218226-2bef-411e-a93a-9915711b49ac" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-94218226-2bef-411e-a93a-9915711b49ac" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1fe0bbae-d7cc-4dee-b679-c2090039ec9c" class="xr-var-data-in" type="checkbox"><label for="data-1fe0bbae-d7cc-4dee-b679-c2090039ec9c" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.129e+03 2.133e+03 ... 2.13e+03</div><input id="attrs-90f54f1a-18a4-435a-bbc7-9fbf7987077e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-90f54f1a-18a4-435a-bbc7-9fbf7987077e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-0ebfa9ee-a3aa-4f52-9493-1bdd88b5c9a0" class="xr-var-data-in" type="checkbox"><label for="data-0ebfa9ee-a3aa-4f52-9493-1bdd88b5c9a0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2128.87276639, 2133.04984242, 2130.14403527, ..., 2128.70169991,
        2131.46894539, 2133.6662019 ],
       [2127.85340154, 2129.84500587, 2127.75593711, ..., 2128.5550997 ,
        2131.50732669, 2131.91516801],
       [2132.50282521, 2129.92338114, 2128.92061644, ..., 2131.15600759,
        2129.97670001, 2129.80874096],
       [2127.33859464, 2127.2312736 , 2128.10522471, ..., 2127.5903735 ,
        2128.48998766, 2129.71688757]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.1638 0.0 ... 0.536 -0.209</div><input id="attrs-68a443d1-fc09-463b-b6cf-3216903b62a0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-68a443d1-fc09-463b-b6cf-3216903b62a0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-6fae4ae2-0740-4475-a23d-76124390135e" class="xr-var-data-in" type="checkbox"><label for="data-6fae4ae2-0740-4475-a23d-76124390135e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-0.1638016 ,  0.        ,  0.00172233, ..., -0.03891625,
         0.64061522, -0.51372942],
       [-0.41280389,  0.28179713, -0.32174279, ...,  0.00694281,
         0.63565112, -0.39447937],
       [-1.07156177,  0.24052964, -0.05041441, ..., -0.30878242,
        -0.38742131,  0.28434482],
       [ 0.10885425, -0.19260795,  0.28973573, ...,  0.05218795,
         0.53598008, -0.20899542]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>index_in_trajectory</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 0 1 -3 0 1 1 ... 1 -2 -5 2 -1 2</div><input id="attrs-c23e6591-e0ae-47c8-aa75-effa873789b6" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-c23e6591-e0ae-47c8-aa75-effa873789b6" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-c743878f-46c4-4a91-b63c-cb63dc7ab939" class="xr-var-data-in" type="checkbox"><label for="data-c743878f-46c4-4a91-b63c-cb63dc7ab939" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[ 2,  0,  1, ...,  2, -2, -1],
       [-1, -1, -2, ...,  1,  2, -2],
       [ 2, -2, -2, ..., -3, -2, -3],
       [-2,  1, -2, ...,  2, -1,  2]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>largest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-4cc6d3f7-6450-4a67-9319-1560a7f8ef4f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4cc6d3f7-6450-4a67-9319-1560a7f8ef4f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a6d99e2f-6f1f-4a3c-9918-db67080917b0" class="xr-var-data-in" type="checkbox"><label for="data-a6d99e2f-6f1f-4a3c-9918-db67080917b0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>lp</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.128e+03 ... -2.128e+03</div><input id="attrs-e72ecc14-fb03-4159-a08b-83ce71766045" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-e72ecc14-fb03-4159-a08b-83ce71766045" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-9f398dc7-ea90-4d18-90de-744d5d65ee92" class="xr-var-data-in" type="checkbox"><label for="data-9f398dc7-ea90-4d18-90de-744d5d65ee92" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-2128.00250572, -2128.00250572, -2128.12919327, ...,
        -2126.96588425, -2130.48481758, -2128.82223783],
       [-2126.01361629, -2127.73086594, -2126.03092856, ...,
        -2126.58273938, -2130.66851691, -2128.17264419],
       [-2126.77806792, -2127.95618791, -2127.44994016, ...,
        -2128.96424333, -2127.48561335, -2128.31356197],
       [-2126.93383996, -2126.05212217, -2127.64202624, ...,
        -2126.53795317, -2128.24409007, -2128.24832098]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>max_energy_error</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-0.3215 0.9764 ... 0.536 -0.3406</div><input id="attrs-848d4f27-47ac-4a35-85f5-6cd32efe2c71" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-848d4f27-47ac-4a35-85f5-6cd32efe2c71" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8dbcf16e-4b33-47ed-9572-dfb43448626a" class="xr-var-data-in" type="checkbox"><label for="data-8dbcf16e-4b33-47ed-9572-dfb43448626a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[-0.32148565,  0.97642086,  0.29411898, ...,  0.18895483,
         0.64061522, -0.51372942],
       [-0.41280389,  0.56143672, -0.32174279, ...,  0.43940302,
         0.65319026, -0.39447937],
       [-1.07156177,  1.02667069, -0.34619047, ..., -0.70159518,
        -0.38742131,  0.47855154],
       [ 0.10885425, -0.19260795,  0.28973573, ...,  0.14723681,
         0.53598008, -0.34064534]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>n_steps</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">3.0 7.0 7.0 3.0 ... 7.0 3.0 3.0 3.0</div><input id="attrs-57e22833-39ab-4817-9c09-bccc7d438e64" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-57e22833-39ab-4817-9c09-bccc7d438e64" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d97b4724-a7bd-4b7e-860c-765bdc3e92a5" class="xr-var-data-in" type="checkbox"><label for="data-d97b4724-a7bd-4b7e-860c-765bdc3e92a5" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[3., 7., 7., ..., 3., 3., 3.],
       [3., 3., 3., ..., 3., 3., 3.],
       [3., 3., 3., ..., 3., 3., 3.],
       [3., 3., 3., ..., 3., 3., 3.]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0004697 0.0008929 ... 0.0005629</div><input id="attrs-749afab3-254b-478f-a730-e2e746a6f499" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-749afab3-254b-478f-a730-e2e746a6f499" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-13ffb5bc-5c31-4306-ae43-c48dbe372678" class="xr-var-data-in" type="checkbox"><label for="data-13ffb5bc-5c31-4306-ae43-c48dbe372678" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00046971, 0.00089294, 0.00089978, ..., 0.00045685, 0.0004466 ,
        0.00044829],
       [0.00069804, 0.00067167, 0.00068786, ..., 0.00072536, 0.00064348,
        0.00052389],
       [0.00069045, 0.00069548, 0.00069009, ..., 0.00039129, 0.00041891,
        0.00038302],
       [0.00042106, 0.00041932, 0.00041471, ..., 0.00042082, 0.00041263,
        0.00056294]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>perf_counter_start</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.426e+04 2.426e+04 ... 2.426e+04</div><input id="attrs-2ad60b91-4e96-47ed-82cc-0e60c52221c0" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-2ad60b91-4e96-47ed-82cc-0e60c52221c0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b3a58ac4-ea26-4ab2-984f-563b3a4533ce" class="xr-var-data-in" type="checkbox"><label for="data-b3a58ac4-ea26-4ab2-984f-563b3a4533ce" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[24257.04731343, 24257.0478862 , 24257.04886589, ...,
        24257.75787857, 24257.75841846, 24257.75894767],
       [24257.23339987, 24257.23422631, 24257.23501706, ...,
        24258.21795199, 24258.21881699, 24258.21955826],
       [24257.51220296, 24257.51302506, 24257.51384824, ...,
        24258.40726047, 24258.40772524, 24258.40821785],
       [24257.41807322, 24257.41858208, 24257.41908315, ...,
        24258.37752693, 24258.37802489, 24258.37898916]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>process_time_diff</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.0004697 0.000893 ... 0.0005636</div><input id="attrs-d73948f0-9bd3-4cd7-9a86-f558e23de4dd" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d73948f0-9bd3-4cd7-9a86-f558e23de4dd" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-26810c4b-946b-4dfc-abc4-8755636eb0ce" class="xr-var-data-in" type="checkbox"><label for="data-26810c4b-946b-4dfc-abc4-8755636eb0ce" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.00046973, 0.00089301, 0.00089992, ..., 0.00045697, 0.00044667,
        0.0004484 ],
       [0.00069807, 0.00067174, 0.00068794, ..., 0.00072562, 0.00064358,
        0.00052395],
       [0.00069056, 0.00069568, 0.00068996, ..., 0.00039139, 0.00040424,
        0.00038308],
       [0.00042104, 0.00041935, 0.0004148 , ..., 0.00042089, 0.00041263,
        0.00056356]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>reached_max_treedepth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">bool</div><div class="xr-var-preview xr-preview">False False False ... False False</div><input id="attrs-ace87159-e904-4e87-a146-02ecc109b9de" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-ace87159-e904-4e87-a146-02ecc109b9de" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-4d52c64c-9a34-4e5b-a2d4-421120284efb" class="xr-var-data-in" type="checkbox"><label for="data-4d52c64c-9a34-4e5b-a2d4-421120284efb" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>smallest_eigval</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">nan nan nan nan ... nan nan nan nan</div><input id="attrs-833cf2ae-1ac2-4fc5-9d98-5d9899d38f0e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-833cf2ae-1ac2-4fc5-9d98-5d9899d38f0e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-b3465639-3281-40a3-8ebc-56e38fe0d4bc" class="xr-var-data-in" type="checkbox"><label for="data-b3465639-3281-40a3-8ebc-56e38fe0d4bc" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.8525 0.8525 ... 1.136 1.136</div><input id="attrs-f5e676d4-d7f3-4dc1-a87c-6bf632cd5c49" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-f5e676d4-d7f3-4dc1-a87c-6bf632cd5c49" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-97f8934f-c01c-40fa-92a1-70a2e4f4894e" class="xr-var-data-in" type="checkbox"><label for="data-97f8934f-c01c-40fa-92a1-70a2e4f4894e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.85253827, 0.85253827, 0.85253827, ..., 0.85253827, 0.85253827,
        0.85253827],
       [0.97092773, 0.97092773, 0.97092773, ..., 0.97092773, 0.97092773,
        0.97092773],
       [0.65623995, 0.65623995, 0.65623995, ..., 0.65623995, 0.65623995,
        0.65623995],
       [1.13615712, 1.13615712, 1.13615712, ..., 1.13615712, 1.13615712,
        1.13615712]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>step_size_bar</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">0.9132 0.9132 ... 0.8944 0.8944</div><input id="attrs-d7fccb64-aed0-4c25-8daf-4ce7b9c0611f" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-d7fccb64-aed0-4c25-8daf-4ce7b9c0611f" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-a8dd1b1f-b4cb-457f-9832-7f81f93ce0ca" class="xr-var-data-in" type="checkbox"><label for="data-a8dd1b1f-b4cb-457f-9832-7f81f93ce0ca" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[0.91319623, 0.91319623, 0.91319623, ..., 0.91319623, 0.91319623,
        0.91319623],
       [0.86880419, 0.86880419, 0.86880419, ..., 0.86880419, 0.86880419,
        0.86880419],
       [0.86744024, 0.86744024, 0.86744024, ..., 0.86744024, 0.86744024,
        0.86744024],
       [0.89443309, 0.89443309, 0.89443309, ..., 0.89443309, 0.89443309,
        0.89443309]])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>tree_depth</span></div><div class="xr-var-dims">(chain, draw)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">2 3 3 2 1 2 2 2 ... 2 2 2 3 3 2 2 2</div><input id="attrs-931f0f47-4591-4757-bc39-5b276e07e224" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-931f0f47-4591-4757-bc39-5b276e07e224" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-947bfeec-5aa0-4d89-bd51-a92fbac9e65b" class="xr-var-data-in" type="checkbox"><label for="data-947bfeec-5aa0-4d89-bd51-a92fbac9e65b" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([[2, 3, 3, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2]])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-9c3fac08-cf1f-4451-87eb-43f5c113823a" class="xr-section-summary-in" type="checkbox"><label for="section-9c3fac08-cf1f-4451-87eb-43f5c113823a" class="xr-section-summary">Indexes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>chain</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-ecec2b19-a2b4-4ddd-9411-887463a07b85" class="xr-index-data-in" type="checkbox"><label for="index-ecec2b19-a2b4-4ddd-9411-887463a07b85" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([0, 1, 2, 3], dtype='int64', name='chain'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>draw</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-d3d7f1c5-b42c-438e-819b-d110d5bcdf80" class="xr-index-data-in" type="checkbox"><label for="index-d3d7f1c5-b42c-438e-819b-d110d5bcdf80" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       990, 991, 992, 993, 994, 995, 996, 997, 998, 999],
      dtype='int64', name='draw', length=1000))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-93f62e46-ee85-478e-b55c-fe5686afd68d" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-93f62e46-ee85-478e-b55c-fe5686afd68d" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-06-05T18:21:11.107541+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0.dev0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>sampling_time :</span></dt><dd>3.078589677810669</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class="xr-section-item">
                  <input id="idata_observed_datab3189171-f3fd-464a-9828-1a9c9837b6ed" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_datab3189171-f3fd-464a-9828-1a9c9837b6ed" class="xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.Dataset&gt;
Dimensions:       (Longitud_obs: 796)
Coordinates:
  * Longitud_obs  (Longitud_obs) int64 0 1 2 3 4 5 6 ... 790 791 792 793 794 795
Data variables:
    Longitud      (Longitud_obs) float64 49.19 51.22 51.22 ... 90.93 97.35 94.19
Attributes:
    created_at:                  2024-06-05T18:21:11.110803+00:00
    arviz_version:               0.19.0.dev0
    inference_library:           pymc
    inference_library_version:   5.15.1
    modeling_interface:          bambi
    modeling_interface_version:  0.13.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.Dataset</div></div><ul class="xr-sections"><li class="xr-section-item"><input id="section-e4471798-7aca-40ba-a2b0-ebbc2cd1c60e" class="xr-section-summary-in" type="checkbox" disabled=""><label for="section-e4471798-7aca-40ba-a2b0-ebbc2cd1c60e" class="xr-section-summary" title="Expand/collapse section">Dimensions:</label><div class="xr-section-inline-details"><ul class="xr-dim-list"><li><span class="xr-has-index">Longitud_obs</span>: 796</li></ul></div><div class="xr-section-details"></div></li><li class="xr-section-item"><input id="section-82943459-b4f8-4abb-b3df-de4d4b591f9b" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-82943459-b4f8-4abb-b3df-de4d4b591f9b" class="xr-section-summary">Coordinates: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">Longitud_obs</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0 1 2 3 4 5 ... 791 792 793 794 795</div><input id="attrs-0952da89-4797-468f-b2db-7cc4f4277609" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-0952da89-4797-468f-b2db-7cc4f4277609" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-dc25d52e-d2bf-450e-b5fc-f35b1a31a0f8" class="xr-var-data-in" type="checkbox"><label for="data-dc25d52e-d2bf-450e-b5fc-f35b1a31a0f8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([  0,   1,   2, ..., 793, 794, 795])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-b2917abd-e415-42a8-8318-1198e764b25f" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-b2917abd-e415-42a8-8318-1198e764b25f" class="xr-section-summary">Data variables: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>Longitud</span></div><div class="xr-var-dims">(Longitud_obs)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">49.19 51.22 51.22 ... 97.35 94.19</div><input id="attrs-3fdcebb3-b399-4fa1-b339-1f48194ccb88" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-3fdcebb3-b399-4fa1-b339-1f48194ccb88" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-8b003a30-f60b-43c9-9f8e-532b0c6b7a5a" class="xr-var-data-in" type="checkbox"><label for="data-8b003a30-f60b-43c9-9f8e-532b0c6b7a5a" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([49.19285714, 51.22142857, 51.22142857, 52.74285714, 48.17857143,
       49.7       , 46.15      , 49.19285714, 50.71428571, 48.17857143,
       50.20714286, 49.7       , 50.20714286, 49.19285714, 49.19285714,
       49.7       , 50.71428571, 48.68571429, 50.20714286, 50.20714286,
       52.23571429, 49.7       , 49.19285714, 53.75714286, 46.15      ,
       52.23571429, 51.72857143, 48.17857143, 52.23571429, 50.71428571,
       49.19285714, 47.67142857, 51.22142857, 48.68571429, 47.67142857,
       49.19285714, 49.19285714, 50.20714286, 49.7       , 52.23571429,
       51.22142857, 49.7       , 48.17857143, 52.23571429, 51.72857143,
       55.27857143, 50.71428571, 53.25      , 52.09239497, 52.9773925 ,
       52.15931415, 54.79551317, 55.88960402, 56.15775148, 56.71321613,
       56.14531822, 54.27152775, 53.18845079, 51.58980471, 56.52740991,
       54.27041965, 53.90327795, 56.31186537, 52.85389383, 56.2498965 ,
       55.3230851 , 52.96168533, 54.83012442, 56.90657333, 56.1674208 ,
       57.87042139, 55.03640928, 61.33037799, 52.78255116, 53.94307754,
       54.84143382, 51.75248234, 56.48636007, 56.19388644, 54.60045215,
       53.89607373, 56.1067215 , 61.39098782, 60.03948235, 59.12081467,
       59.47145582, 56.87930169, 57.01821414, 55.0298334 , 57.57946143,
       59.89906647, 57.77073394, 56.61548298, 57.92039996, 59.38318439,
       57.60909694, 59.98242783, 55.18881162, 56.40744072, 56.98018785,
...
       82.65200072, 84.37440979, 91.3085265 , 79.96338712, 81.61261347,
       84.29581338, 88.81517149, 80.29882513, 77.40305079, 87.23796829,
       84.06027194, 91.38395098, 89.59787794, 91.62079733, 92.81936454,
       92.24137361, 76.43942909, 77.71863214, 88.55951887, 88.96395213,
       77.95509383, 82.74625965, 91.23181564, 92.76141866, 85.54573872,
       89.36846664, 89.10512726, 90.92382869, 90.97831844, 85.31646661,
       83.2178514 , 82.74694287, 84.24183082, 88.53873707, 84.24292413,
       77.67609253, 91.9678806 , 91.14871479, 84.65728687, 97.43958338,
       86.3573666 , 90.30806077, 86.76620237, 78.94318283, 89.86260498,
       86.70593948, 92.2386928 , 86.73034187, 81.02343959, 90.37105389,
       80.49576392, 85.51492889, 91.65871132, 88.5279465 , 94.06219176,
       87.13126778, 82.14414651, 83.48512537, 84.1944379 , 90.25150091,
       85.40245169, 84.7221104 , 74.23082134, 92.32109173, 85.30380521,
       86.94866672, 88.17681991, 79.07148226, 87.27725659, 93.07974128,
       87.50474804, 78.82336361, 88.3197443 , 89.21055719, 85.10846706,
       87.99056523, 84.5124126 , 87.9681095 , 83.8704532 , 89.92279315,
       89.15198916, 87.85582658, 83.9765828 , 94.82978854, 89.38589518,
       94.6727304 , 75.4419031 , 95.4900717 , 96.4306434 , 84.42186434,
       86.15102724, 83.64517681, 81.13556856, 90.92918567, 97.35113965,
       94.193379  ])</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-5af4e6bd-84a5-4cdc-ab62-3bb4d9485a3c" class="xr-section-summary-in" type="checkbox"><label for="section-5af4e6bd-84a5-4cdc-ab62-3bb4d9485a3c" class="xr-section-summary">Indexes: <span>(1)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>Longitud_obs</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-f7465035-af75-44e6-ab48-ff227d876ac3" class="xr-index-data-in" type="checkbox"><label for="index-f7465035-af75-44e6-ab48-ff227d876ac3" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       786, 787, 788, 789, 790, 791, 792, 793, 794, 795],
      dtype='int64', name='Longitud_obs', length=796))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-c5810a46-809e-4f32-af2f-7ea8793e857b" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c5810a46-809e-4f32-af2f-7ea8793e857b" class="xr-section-summary">Attributes: <span>(6)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>created_at :</span></dt><dd>2024-06-05T18:21:11.110803+00:00</dd><dt><span>arviz_version :</span></dt><dd>0.19.0.dev0</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.15.1</dd><dt><span>modeling_interface :</span></dt><dd>bambi</dd><dt><span>modeling_interface_version :</span></dt><dd>0.13.0</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>ref <span class="op">=</span> <span class="fl">52.5</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>y_ppc <span class="op">=</span> idata_dis.posterior_predictive[<span class="st">"Longitud"</span>].stack(sample<span class="op">=</span>(<span class="st">"chain"</span>, <span class="st">"draw"</span>))</span>
<span id="cb42-3"><a href="#cb42-3"></a>grid, pdf <span class="op">=</span> az.stats.density_utils._kde_linear(y_ppc.values)</span>
<span id="cb42-4"><a href="#cb42-4"></a>plt.plot(grid, pdf)</span>
<span id="cb42-5"><a href="#cb42-5"></a>percentile <span class="op">=</span> <span class="bu">int</span>((y_ppc <span class="op">&lt;=</span> ref).mean() <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb42-6"><a href="#cb42-6"></a>plt.fill_between(</span>
<span id="cb42-7"><a href="#cb42-7"></a>    grid[grid <span class="op">&lt;</span> ref],</span>
<span id="cb42-8"><a href="#cb42-8"></a>    pdf[grid <span class="op">&lt;</span> ref],</span>
<span id="cb42-9"><a href="#cb42-9"></a>    label<span class="op">=</span><span class="st">"percentilo = </span><span class="sc">{:2d}</span><span class="st">"</span>.<span class="bu">format</span>(percentile),</span>
<span id="cb42-10"><a href="#cb42-10"></a>    color<span class="op">=</span><span class="st">"C1"</span>,</span>
<span id="cb42-11"><a href="#cb42-11"></a>)</span>
<span id="cb42-12"><a href="#cb42-12"></a>plt.xlabel(<span class="st">"Longitud"</span>)</span>
<span id="cb42-13"><a href="#cb42-13"></a>plt.yticks([])</span>
<span id="cb42-14"><a href="#cb42-14"></a>plt.legend()<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predictores-categóricos" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="predictores-categóricos"><span class="header-section-number">7.6</span> Predictores Categóricos</h2>
<p>Una variable categórica representa distintos grupos o categorías. La variable solo puede tomar un conjunto limitado de valores de esas categorías. Estos valores suelen ser etiquetas o nombres que no poseen significado numérico por sí solos. Algunos ejemplos son:</p>
<ul>
<li>Afiliación política: conservadora, liberal o progresista.</li>
<li>Sexo: femenino o masculino.</li>
<li>Nivel de satisfacción del cliente: muy insatisfecho, insatisfecho, neutral, satisfecho o muy satisfecho.</li>
</ul>
<p>Los modelos de regresión lineal pueden acomodar fácilmente variables categóricas, solo necesitamos codificar las categorías como números. Hay algunas opciones para hacerlo. Bambi puede manejar fácilmente los detalles por nosotros. El diablo está en los detalles de como interpretamos los resultados.</p>
<section id="pingüinos-categóricos" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="pingüinos-categóricos"><span class="header-section-number">7.6.1</span> Pingüinos Categóricos</h3>
<p>Para el ejemplo actual, vamos a utilizar el conjunto de datos de <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081">Palmer Penguins</a>, que contiene 344 observaciones de 8 variables. Por el momento nos interesa modelar la masa de los pingüinos en función de la longitud de su pico. Se espera que la masa de los pingüinos aumente a medida que aumenta la longitud del pico. La novedad de este ejemplo es que vamos a considerar la variable categórica, <code>species</code>. Esta variable tiene 3 categorías o niveles, a saber, <code>Adelie</code>, <code>Chinstrap</code> y <code>Gentoo</code>. La <a href="#fig-scatter_pen" class="quarto-xref">Figura&nbsp;<span>7.1</span></a> muestra un diagrama de dispersión para las variables que queremos modelar.</p>
<div id="cell-55" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>penguins <span class="op">=</span> pd.read_csv(<span class="st">"datos/penguins.csv"</span>).dropna()</span>
<span id="cb43-2"><a href="#cb43-2"></a>penguins.head()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">species</th>
<th data-quarto-table-cell-role="th">island</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">bill_depth</th>
<th data-quarto-table-cell-role="th">flipper_length</th>
<th data-quarto-table-cell-role="th">body_mass</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.91</td>
<td>1.87</td>
<td>18.1</td>
<td>3.75</td>
<td>male</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.95</td>
<td>1.74</td>
<td>18.6</td>
<td>3.80</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>4.03</td>
<td>1.80</td>
<td>19.5</td>
<td>3.25</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.67</td>
<td>1.93</td>
<td>19.3</td>
<td>3.45</td>
<td>female</td>
<td>2007</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>Adelie</td>
<td>Torgersen</td>
<td>3.93</td>
<td>2.06</td>
<td>19.0</td>
<td>3.65</td>
<td>male</td>
<td>2007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-fig-scatter_pen" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Get unique categories</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>unique_categories <span class="op">=</span> np.unique(penguins.species)</span>
<span id="cb44-3"><a href="#cb44-3"></a></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co"># Create color map for categories</span></span>
<span id="cb44-5"><a href="#cb44-5"></a>category_color_map <span class="op">=</span> {cat: <span class="ss">f"C</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i, cat <span class="kw">in</span> <span class="bu">enumerate</span>(unique_categories)}</span>
<span id="cb44-6"><a href="#cb44-6"></a></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co"># Generate colors for each category</span></span>
<span id="cb44-8"><a href="#cb44-8"></a>colors <span class="op">=</span> [category_color_map[cat] <span class="cf">for</span> cat <span class="kw">in</span> penguins.species]</span>
<span id="cb44-9"><a href="#cb44-9"></a></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co"># Create scatter plot for each category</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="cf">for</span> cat <span class="kw">in</span> unique_categories:</span>
<span id="cb44-12"><a href="#cb44-12"></a>    category_data <span class="op">=</span> penguins[penguins.species <span class="op">==</span> cat]</span>
<span id="cb44-13"><a href="#cb44-13"></a>    plt.scatter(category_data.body_mass, category_data.bill_length, c<span class="op">=</span>category_color_map[cat], label<span class="op">=</span>cat)</span>
<span id="cb44-14"><a href="#cb44-14"></a></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="co"># Add labels and legend</span></span>
<span id="cb44-16"><a href="#cb44-16"></a>plt.ylabel(<span class="st">"Body mass (g)"</span>)</span>
<span id="cb44-17"><a href="#cb44-17"></a>plt.xlabel(<span class="st">"Bill length (mm)"</span>)</span>
<span id="cb44-18"><a href="#cb44-18"></a>plt.legend(labels<span class="op">=</span>unique_categories, loc<span class="op">=</span><span class="st">"lower right"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-scatter_pen" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter_pen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-scatter_pen-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter_pen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.1: Largo del pico (bill_length) vs masa (body_mass) para 3 especies de pingüinos.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para ajustar un modelo con variables categoricas no necesitamos de ninguna sintáxis especial</p>
<div id="cell-58" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>modelo_p <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_length + species"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb45-2"><a href="#cb45-2"></a>idata_p <span class="op">=</span> modelo_p.fit()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_length, species]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 3 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"bdce6696f540407fb922528c79eadbf4","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>La <a href="#fig-penguins_posterior" class="quarto-xref">Figura&nbsp;<span>7.2</span></a> muestra un forest plot para <code>model_p</code>. ¿Notás algo inesperado? No hay valores posteriores para <code>Adelie</code>. Esto no es un error. De forma predeterminada, Bambi codifica variables categóricas con <code>N</code> niveles (3 especies) como <code>N-1</code> variables (2 especies). Así, los coeficientes <code>species-Chinstrap</code> y <code>species-Gentoo</code> representan deflecciones del modelo base:</p>
<p><span class="math display">\[
\text{body\_mass} = \beta_0 + \beta_1 \text{bill\_length}
\]</span></p>
<div id="cell-fig-penguins_posterior" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>ax <span class="op">=</span> az.plot_forest(idata_p, combined<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">3</span>))</span>
<span id="cb47-2"><a href="#cb47-2"></a>mean_chinstrap <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Chinstrap"</span>).mean()</span>
<span id="cb47-3"><a href="#cb47-3"></a>mean_gentoo <span class="op">=</span> idata_p.posterior[<span class="st">"species"</span>].sel(species_dim<span class="op">=</span><span class="st">"Gentoo"</span>).mean()</span>
<span id="cb47-4"><a href="#cb47-4"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_chinstrap<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_chinstrap , <span class="fl">2.5</span>), weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb47-5"><a href="#cb47-5"></a>ax[<span class="dv">0</span>].annotate(<span class="ss">f"</span><span class="sc">{</span>mean_gentoo<span class="sc">.</span>item()<span class="sc">:.2f}</span><span class="ss">"</span>, (mean_gentoo , <span class="fl">1.7</span>), weight<span class="op">=</span><span class="st">'bold'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-penguins_posterior" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-penguins_posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-penguins_posterior-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-penguins_posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.2: Fores plot para la distribución a posteriori de <code>modelo_p</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Para que esto quede más claro, revisemos un par de gráficos. Podemos leer la <a href="#fig-penguins_posterior" class="quarto-xref">Figura&nbsp;<span>7.2</span></a> como que la masa corporal de <code>Chinstrap</code> es en promedio -0.89 respecto de la masa corporal media de <code>Adelie</code>. Lo mismo ocurre con <code>Gentoo</code>, pero esta vez tenemos que agregar 0,66 a la media del modelo base. Podés comprobar que estas dos afirmaciones son verdaderas mirando la <a href="#fig-penguins_predictions" class="quarto-xref">Figura&nbsp;<span>7.3</span></a>. Observá cómo las 3 líneas son esencialmente paralelas entre sí con <code>Adelie</code> en el medio, <code>Chinstrap</code> debajo (-0,89) y <code>Gentoo</code> arriba (0,58).</p>
<div class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>bmb.interpret.plot_predictions(modelo_p, idata_p, [<span class="st">"bill_length"</span>,  <span class="st">"species"</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-penguins_predictions" class="cell quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="33">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-penguins_predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div id="fig-penguins_predictions-1" class="cell-output cell-output-display quarto-figure quarto-figure-center quarto-float anchored" data-execution_count="33">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-penguins_predictions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<pre id="fig-penguins_predictions-1" class="cell-output cell-output-display" data-execution_count="33"><code>(&lt;Figure size 3450x1500 with 1 Axes&gt;,
 array([&lt;Axes: xlabel='bill_length', ylabel='body_mass'&gt;], dtype=object))</code></pre>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-penguins_predictions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Predicciones del ajuste medio para <code>modelo_p</code>.
</figcaption>
</figure>
</div>
<div class="cell-output cell-output-display">
<div id="fig-penguins_predictions-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-penguins_predictions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-penguins_predictions-output-2.png" id="fig-penguins_predictions-2" class="img-fluid figure-img" data-ref-parent="fig-penguins_predictions">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-penguins_predictions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-penguins_predictions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.3
</figcaption>
</figure>
</div>
</div>
</section>
<section id="relación-con-modelos-jerárquicos" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="relación-con-modelos-jerárquicos"><span class="header-section-number">7.6.2</span> Relación con modelos jerárquicos</h3>
<p>En el <a href="03_Modelos_jerárquicos.html" class="quarto-xref"><span>Capítulo 4</span></a> analizamos y contrastamos los modelos agrupados y jerárquicos (o parcialmente agrupados). Allí mostramos que a menudo podemos aprovechar la estructura o las jerarquías de los datos. Siguiendo la lógica de ese capítulo, se podría argumentar que <code>Adelie</code>, <code>Gentoo</code> y <code>Chinstrap</code>, aunque son especies diferentes, son todos pingüinos. Por lo tanto, modelar jerárquicamente sus masas corporales puede ser una buena idea. Entonces, ¿Cuál es la diferencia entre dicho modelo y el que utilizamos en esta sección?</p>
<p>El factor distintivo reside en las sutilezas de los componentes de pendiente e intersección. En el caso de <code>model_p</code> (variables categóricos), la pendiente sigue siendo la misma en las tres especies de pingüinos, mientras que los interceptos pueden variar. <code>Intercept + 0</code> para <code>Adelie</code>, <code>Intercept + species[Chinstrap]</code> para Chinstrap, y <code>Intercept + species[Gentoo]</code> para <code>Gentoo</code>. Por lo tanto, este modelo resalta los distintos incerceptos manteniendo la pendiente uniforme.</p>
<p>Si, en cambio, hubiéramos construido el modelo jerárquico <code>body_mass ~ bill_length|species)</code>, habríamos estado pidiendo una pendiente y un intercepto parcialmente agrupados. Y si en lugar de eso hubiéramos modelado <code>body_mass ~ (0 + bill_length | specie)</code> habríamos estado pidiendo una pendiente parcialmente agrupada y un intercepto común.</p>
<p>Entonces, ¿Cuál es mejor modelo? Como siempre, depende, incluso en algunos casos podría ser mejor una combinación de ambos enfoques, ya que no son ideas mutuamente excluyentes. Como ya comentamos, el <em>mejor</em> modelo es el que se alinea con los objetivos de tu análisis y proporciona información útil. A menudo es una buena idea explorar múltiples modelos, comparar su desempeño usando criterios apropiados (como los discutidos en el <a href="07_Comparación_de_modelos.html" class="quarto-xref"><span>Capítulo 8</span></a> y considerar las implicaciones prácticas de cada modelo en el contexto de la investigación o proceso de toma de decisiones.</p>
</section>
</section>
<section id="interacciones" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="interacciones"><span class="header-section-number">7.7</span> Interacciones</h2>
<p>Un efecto de interacción o interacción estadística, ocurre cuando el efecto de una variable independiente sobre la respuesta cambia dependiendo del valor de otra variable independiente en el mismo modelo. Una interacción puede ocurrir entre dos o más variables. Algunos ejemplos son:</p>
<ul>
<li>Eficacia de los medicamentos y edad: un medicamento que funciona mejor en personas mayores que en personas más jóvenes</li>
<li>Nivel de educación e impacto en los ingresos: Es posible que la educación superior tenga un efecto positivo más fuerte en los ingresos de un género en comparación con el otro, lo que resulta en una interacción entre la educación y el género.</li>
<li>Efectos del ejercicio y la dieta sobre la pérdida de peso: Podría ser que el efecto de la dieta sobre la pérdida de peso sea pequeño para las personas que hacen nada o poco ejercicio y muy importante para las personas que hacen ejercicio moderado.</li>
<li>*Temperatura y humedad para el crecimiento de los cultivos: El efecto de la temperatura y la humedad en el crecimiento de los cultivos puede depender del tipo de cultivo que se esté cultivando. Algunos cultivos podrían prosperar en condiciones cálidas y húmedas, mientras que otros podrían funcionar mejor en ambientes más fríos y menos húmedos, creando una interacción entre temperatura, humedad y tipo de cultivo.</li>
</ul>
<p>Tenemos una interacción cuando el efecto combinado de dos o más variables actuando conjuntamente no es igual a la suma de sus efectos individuales. Si tenemos un modelo como</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \beta_1 X_1
\]</span></p>
<p>no podemos modelar un interacción, ya que los efectos son aditivos. La forma más común de modelar una interacción es multiplicando 2 o más variables. Por ejemplo en un modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \overbrace{\beta_0 X_0 + \beta_1 X_1 }^{\text{término principal}} \; + \underbrace{\beta_3 X_0X_1}_{\text{término de interacción}}
\]</span></p>
<p>Es común que al modelar una interacción se incluya también el término principal.</p>
<blockquote class="blockquote">
<p>Multiplicar dos variables puede verse como un truco similar al que usamos para la regresión polinómica (o cualquier transformación de una variable determinada). En lugar de multiplicar un predictor consigo mismo, multiplicamos dos predictores diferentes y obtenemos uno nuevo.</p>
</blockquote>
<p>Definir una interacción es fácil; para un modelo PyMC, solo necesitamos multiplicar los dos predictores y agreagar un coeficiente más al modelo. Para que un modelo de Bambi es aún más fácil, usamos el operador <code>:</code>. Veamos un ejemplo de un modelo con y sin interacciones.</p>
<div id="cell-65" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Sin interacción</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>model_noint <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb49-3"><a href="#cb49-3"></a>idata_noint <span class="op">=</span> model_noint.fit()</span>
<span id="cb49-4"><a href="#cb49-4"></a></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="co"># COn interacción</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>model_int <span class="op">=</span> bmb.Model(<span class="st">"body_mass ~ bill_depth + bill_length + bill_depth:bill_length"</span>, data<span class="op">=</span>penguins)</span>
<span id="cb49-7"><a href="#cb49-7"></a>idata_int <span class="op">=</span> model_int.fit()</span>
<span id="cb49-8"><a href="#cb49-8"></a>                    </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 2 seconds.
Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [body_mass_sigma, Intercept, bill_depth, bill_length, bill_depth:bill_length]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 11 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"b5cc8651410b4f758f7a6e824141fb63","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"a42e5f5329254bb09dc219131f810a1e","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>En la <a href="#fig-interaction_vs_noninteraction" class="quarto-xref">Figura&nbsp;<span>7.4</span></a> tenemos el ajuste de regresión media para <code>bill_depth</code> evaluado en 5 valores fijos de <code>bill_length</code>. A la izquierda tenemos el resultado dpara <code>model_noint</code> (sin interacciones) y a la derecha para <code>model_int</code> (con interacciones). Podemos ver que cuando no tenemos interacciones las rectas ajustadas para <code>bill_ depth</code> son paralelas en diferentes niveles de <code>bill_length</code>. En cambio, cuando tenemos interacciones las rectas ya no son paralelas, precisamente porque el efecto de cambiar <code>bill_depth</code> sobre cuánto cambia <code>body_mass</code> ya no es constante sino que está modulado por los valores de <code>bill_length</code>. Si generás una figura como <a href="#fig-interaction_vs_noninteraction" class="quarto-xref">Figura&nbsp;<span>7.4</span></a>, pero fijando <code>bill_depth</code> en vez de <code>bill_length</code> observarás un fenómeno parecido.</p>
<div id="cell-fig-interaction_vs_noninteraction" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>_, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="fl">4.5</span>), gridspec_kw<span class="op">=</span>{<span class="st">'hspace'</span>: <span class="fl">0.1</span>})</span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a>bmb.interpret.plot_predictions(model_noint, idata_noint,</span>
<span id="cb51-4"><a href="#cb51-4"></a>                                [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb51-5"><a href="#cb51-5"></a>                                ax<span class="op">=</span>axes[<span class="dv">0</span>],</span>
<span id="cb51-6"><a href="#cb51-6"></a>                                legend<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb51-7"><a href="#cb51-7"></a>                                )</span>
<span id="cb51-8"><a href="#cb51-8"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Sin interacción"</span>)</span>
<span id="cb51-9"><a href="#cb51-9"></a></span>
<span id="cb51-10"><a href="#cb51-10"></a></span>
<span id="cb51-11"><a href="#cb51-11"></a>bmb.interpret.plot_predictions(model_int, idata_int,</span>
<span id="cb51-12"><a href="#cb51-12"></a>                               [<span class="st">"bill_depth"</span>,  <span class="st">"bill_length"</span>],</span>
<span id="cb51-13"><a href="#cb51-13"></a>                                ax<span class="op">=</span>axes[<span class="dv">1</span>],</span>
<span id="cb51-14"><a href="#cb51-14"></a>                                )</span>
<span id="cb51-15"><a href="#cb51-15"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Con interacción"</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/pymc/lib/python3.11/site-packages/bambi/interpret/utils.py:383: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if is_string_dtype(x) or is_categorical_dtype(x):
/home/osvaldo/anaconda3/envs/pymc/lib/python3.11/site-packages/bambi/interpret/utils.py:383: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if is_string_dtype(x) or is_categorical_dtype(x):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_vs_noninteraction" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_vs_noninteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_vs_noninteraction-output-2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_vs_noninteraction-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.4: Comparación de un modelo sin interacción (las lineas se mantienen paralelas) y con interacción (las lineas se cruzan).
</figcaption>
</figure>
</div>
</div>
</div>
<p>Acabamos de ver visualmente que interpretar modelos lineales con interacciones no es tan fácil como interpretar modelos lineales sin ellas. Veamos esto matemáticamente:</p>
<p>Supongamos que tenemos un modelo con 2 variables <span class="math inline">\(X_0\)</span> y <span class="math inline">\(X_1\)</span> y una interacción entre ellas:</p>
<p><span class="math display">\[
     \mu = \alpha + \beta_0 X_0 + \beta_1 X_1 + \beta_3 X_0X_1
\]</span></p>
<p>podemos reescribir este modelo como:</p>
<p><span class="math display">\[
\mu = \alpha + \underbrace{{(\beta_0 + \beta_2} X_1)}_{\text{pendiente de } X_0} X_0 + \beta_1 X_1
\]</span></p>
<p>o así:</p>
<p><span class="math display">\[
\mu = \alpha + \beta_0 X_0 + \underbrace{(\beta_1 + \beta_2 x_0)}_{\text{pendiente de } X_1} X_1
\]</span></p>
<p>Esto nos muestra el siguiente gráfico de Fores para la distribución a posteriori de:</p>
<ul>
<li>¡El término de interacción puede entenderse como un modelo lineal dentro de un modelo lineal!</li>
<li>La interacción es simétrica; podemos pensar en ello como la pendiente de <span class="math inline">\(x_0\)</span> en función de <span class="math inline">\(x_1\)</span> y al mismo tiempo como la pendiente de <span class="math inline">\(x_1\)</span> en función de <span class="math inline">\(x_0\)</span>. Esto también se puede ver en la figura interactiva.</li>
<li>Sabemos desde antes que el coeficiente <span class="math inline">\(\beta_0\)</span> se puede interpretar como la cantidad de cambio de <span class="math inline">\(\mu\)</span> por unidad de cambio de <span class="math inline">\(x_0\)</span> (por eso lo llamamos pendiente). Si agregamos un término de interacción, entonces esto solo es cierto en <span class="math inline">\(x_1 = 0\)</span>. Intente utilizar la figura interactiva para verlo usted mismo. Matemáticamente, esto es cierto porque cuando <span class="math inline">\(x_1 = 0\)</span> entonces <span class="math inline">\(\beta_2x_1 = 0\)</span>, y por lo tanto la pendiente de <span class="math inline">\(x_0\)</span> se reduce a <span class="math inline">\(\beta_0 x_0\)</span>. Por simetría, el mismo razonamiento se puede aplicar a <span class="math inline">\(\beta_1\)</span>. \end{detallar}</li>
</ul>
</section>
<section id="interpretando-modelos-con-bambi" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="interpretando-modelos-con-bambi"><span class="header-section-number">7.8</span> Interpretando modelos con Bambi</h2>
<p>Ya hemos usado <code>bmb.interpret_plot_predictions</code> en este capítulo. Pero esa no es la única herramienta que nos ofrece Bambi para ayudarnos a comprender los modelos. Otra opción es <code>bmb.interpret_plot_comparisons</code>. Esta herramienta nos ayuda a responder la pregunta: ¿Cuál es la diferencia predictiva esperada cuando comparamos dos valores de una variable determinada mientras mantenemos el resto en valores constantes?</p>
<p>Como ejemplo usemos <code>model_int</code>, que ya ajustamos en la sección anterior.</p>
<div id="cell-fig-interaction_comparisons" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>bmb.interpret.plot_comparisons(model_int, idata_int,</span>
<span id="cb53-2"><a href="#cb53-2"></a>                               contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb53-3"><a href="#cb53-3"></a>                               conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_comparisons" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_comparisons-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_comparisons-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.5: Contraste de para <code>bill_length</code> de 1,8 a 1,4 cm para 3 valores fijos de <code>bill_length</code>, 3.5, 4.5 y 5.5.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-interaction_comparisons" class="quarto-xref">Figura&nbsp;<span>7.5</span></a> muestra que al comparar un pingüino hipotético con profundidad de pico (<code>bill_depth</code>) de 1,8 con uno con profundida de pico de 1,4, la diferencia esperada es:</p>
<ul>
<li>aproximadamente 0,8 kg para un pico de 3,5 de longitud</li>
<li>-0,7 kg para un pico de 4,5 de largo</li>
<li>aproximadamente -2 kg para un pico de 5,5 de largo</li>
</ul>
<p>Para obtener esta misma información, pero en forma de tabla podemos usar la función <code>bmb.interpret.comparisons</code> y obtendremos un DataFrame de Pandas.</p>
<div id="cell-72" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a>bmb.interpret.comparisons(model_int, idata_int,</span>
<span id="cb54-2"><a href="#cb54-2"></a>                          contrast<span class="op">=</span>{<span class="st">"bill_depth"</span>:[<span class="fl">1.4</span>, <span class="fl">1.8</span>]},</span>
<span id="cb54-3"><a href="#cb54-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">estimate_type</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">estimate</th>
<th data-quarto-table-cell-role="th">lower_3.0%</th>
<th data-quarto-table-cell-role="th">upper_97.0%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>3.5</td>
<td>0.771034</td>
<td>0.493606</td>
<td>1.022379</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>4.5</td>
<td>-0.567754</td>
<td>-0.674837</td>
<td>-0.458393</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bill_depth</td>
<td>diff</td>
<td>(1.4, 1.8)</td>
<td>5.5</td>
<td>-1.906541</td>
<td>-2.176603</td>
<td>-1.656448</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Otra función muy útil es Otra función útil es <code>bmb.interpret_plot_slopes</code>. Esta función es similar a <code>bmb.interpret_plot_comparison</code>, la “tasa de cambio instantánea” o pendiente en un valor dado.</p>
<div id="cell-fig-interaction_slopes" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>bmb.interpret.plot_slopes(model_int, idata_int,</span>
<span id="cb55-2"><a href="#cb55-2"></a>                          wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb55-3"><a href="#cb55-3"></a>                          conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/pymc/lib/python3.11/site-packages/bambi/interpret/effects.py:841: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if is_categorical_dtype(model.data[wrt_name]) or is_string_dtype(model.data[wrt_name]):</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-interaction_slopes" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interaction_slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06_Regresión_lineal_con_Bambi_files/figure-html/fig-interaction_slopes-output-2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interaction_slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7.6: Comparación de las pendientes de bill_depth evaluada en 1.8 para tres valores de <code>bill_length</code>, 3.5, 4.5 y 5.5.
</figcaption>
</figure>
</div>
</div>
</div>
<p>La <a href="#fig-interaction_slopes" class="quarto-xref">Figura&nbsp;<span>7.6</span></a> muestra que las pendientes para <code>bill_depth</code> en 1.8 son:</p>
<ul>
<li><span class="math inline">\(\approx\)</span> 2 kg/cm para un largo de pico de 3.5</li>
<li>-1.4 kg/cm para un largo de pico de4.5</li>
<li><span class="math inline">\(\approx\)</span> -5 kg/cm para un largo de pico de 5.5</li>
</ul>
<p>Si deseas esta información en forma tabular, podés usar: la función <code>bmb.interpret.slopes</code> y obtendrás un DataFrame en lugar de un gráfico.</p>
<div id="cell-76" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Mostrar Código</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>bmb.interpret.slopes(model_int, idata_int,</span>
<span id="cb57-2"><a href="#cb57-2"></a>                     wrt<span class="op">=</span>{<span class="st">"bill_depth"</span>:<span class="fl">1.8</span>},</span>
<span id="cb57-3"><a href="#cb57-3"></a>                     conditional<span class="op">=</span>{<span class="st">"bill_length"</span>:[<span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>]})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/anaconda3/envs/pymc/lib/python3.11/site-packages/bambi/interpret/effects.py:841: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if is_categorical_dtype(model.data[wrt_name]) or is_string_dtype(model.data[wrt_name]):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">term</th>
<th data-quarto-table-cell-role="th">estimate_type</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">bill_length</th>
<th data-quarto-table-cell-role="th">estimate</th>
<th data-quarto-table-cell-role="th">lower_3.0%</th>
<th data-quarto-table-cell-role="th">upper_97.0%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>3.5</td>
<td>1.927586</td>
<td>1.234014</td>
<td>2.555948</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>4.5</td>
<td>-1.419384</td>
<td>-1.687093</td>
<td>-1.145983</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bill_depth</td>
<td>dydx</td>
<td>(1.8, 1.8001)</td>
<td>5.5</td>
<td>-4.766354</td>
<td>-5.441507</td>
<td>-4.141119</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>En esta sección, apenas hemos arañado la superficie de lo que podemos hacer con las herramientas del módulo <code>bmb.interpret</code>. Este módulo es una característica muy útil de Bambi, especialmente para modelos con interacciones y/o modelos con funciones de enlace distintas a la función de identidad. Les recomiendo que lea la <a href="https://bambinos.github.io/bambi/notebooks/#tools-to-interpret-model-outputs">documentación</a> de Bambi para obtener más ejemplos y detalles que no se tratan aquí.</p>
</section>
<section id="selección-de-variables" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="selección-de-variables"><span class="header-section-number">7.9</span> Selección de Variables</h2>
<p>La selección de variables se refiere al proceso de identificar las variables más relevantes en un modelo a partir de un conjunto más amplio de predictores. Realizamos la selección de variables bajo el supuesto de que sólo un subconjunto de variables tiene un impacto considerable en el resultado de interés, mientras que otras aportan poco o ningún valor adicional.</p>
<p>Podría decirse que “lo más bayesiano que se puede hacer” al construir un modelo es incluir todas las variables que podamos pensar en un solo modelo y luego usar la distribución a posteriori de ese modelo para hacer predicciones o comprender las relaciones de las variables. Este es el enfoque “más bayesiano” porque utilizamos la mayor cantidad de datos posible e incorporamos en la distribución a posteriori la incertidumbre sobre la importancia de las variables. Sin embargo, ser <em>más bayesiano que Bayes</em> no siempre es la mejor idea.</p>
<p>Realizar selección de variables es una buena idea cuando:</p>
<ul>
<li><p>Necesitamos reducir el costo de medición. Por ejemplo, en medicina, es posible que tengamos el dinero y los recursos para realizar un estudio piloto y medir 30 variables para 200 pacientes. Pero no podemos hacer lo mismo con miles de personas. O tal vez podamos colocar muchos sensores en un campo para modelar el rinde de un cultivo, pero no podemos extender eso mismo al tamaño de toda una región productiva. Reducir costos no siempre es cuestión de dinero o tiempo. Cuando se trabaja con humanos u otros animales, también es importante reducir el dolor y la incomodidad.</p></li>
<li><p>Queremos reducir el costo computacional. Esto no es un problema para modelos pequeños y simples, pero cuando tenemos muchas variables, muchos datos o ambos, el costo computacional puede ser prohibitivo.</p></li>
<li><p>Buscamos una mejor comprensión de las estructuras de correlación significativas. Es decir, nos interesa entender qué variables proporcionan mejores predicciones. Es importante aclarar que no estamos hablando de causalidad. Si bien los modelos estadísticos, en particular los GLMS, pueden usarse para inferir causalidad, hacerlo requiere pasos y suposiciones adicionales. En este curso no discutimos cómo realizar inferencia causal. Para obtener una introducción muy sencilla a la inferencia causal, consulte <a href="https://www.youtube.com/watch?v=gV6wzTk3o1U">este vídeo</a>. O si su inteŕes es más serio, puede consultar el libro en <a href="https://mixtape.scunning.com/">Causal Inference</a>: The Mixtape de Scott Cunningham. También el paquete <a href="https://github.com/pymc-labs/CausalPy">CausalPy</a></p></li>
<li><p>Cuando deseamos un modelo que sea más robusto a los cambios en la distribución generadora de datos, podemos ver la selección de variables como un método para hacer que el modelo sea más robusto frente a datos no representativos.</p></li>
</ul>
</section>
<section id="inferencia-predictiva-por-proyección" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="inferencia-predictiva-por-proyección"><span class="header-section-number">7.10</span> Inferencia predictiva por proyección</h2>
<p>Existen muchos métodos para realizar selección de variables. En esta sección, nos centraremos en uno de ellos llamado inferencia predictiva por proyección . La razón principal por la que nos centramos en este método es que ha mostrado un rendimiento muy bueno en una amplia gama de problemas.</p>
<p>Los principales pasos de la iinferencia predictiva por proyección son:</p>
<ul>
<li>Generar un modelo de referencia, es decir, un modelo con todas las variables que creas que pueden ser relevantes y/o pudiste medir.</li>
<li>Generar un conjunto de submodelos, es decir, modelos que solo incluyen algún subconjunto de las variables presentens en el modelo de referencia.</li>
<li>Eligir el modelo más pequeño que haga predicciones lo suficientemente cercanas al modelo de referencia.</li>
</ul>
<p>Al realizar inferencia predictiva por proyección, solo necesitamos realizar la inferencia Bayesiana “tradicional” una sola vez, solo para el modelo de referencia. Para los submodelos, las distribuciones a psoteriori se obtienen por proyección. Sin entrar en detalles técnicos, la proyección consiste en encontrar los parámetros para los submodelos de tal forma que las predicciones de los submodelos sean lo más cercanas posible a las predicciones del modelo de referencia. La proyección se puede realizar de una manera computacionalmente eficiente, por lo que el costo de estimar un posterior es mucho más económico que con los métodos MCMC. Esto es relevante porque el número total de submodelos posibles explota a medida que aumentamos el número de variables en el modelo de referencia. Considere que necesitamos evaluar todas las combinaciones posibles, sin repetir variables. Por ejemplo, digamos que tenemos cuatro variables (<span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span> y <span class="math inline">\(D\)</span>) y necesitamos evaluar 7 modelos, a saber, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(AB\)</span>, <span class="math inline">\(BC\)</span>, <span class="math inline">\(AC\)</span> y el modelo de referencia <span class="math inline">\(ABC\)</span>. Siete no parece mucho, pero cuando tengamos 8 variables, necesitaremos evaluar 92 modelos diferentes. Duplicamos la cantidad de variables y la cantidad de modelos aumentó más de 10 veces!</p>
<p>Por supuesto, hay formas de reducir el número total de submodelos a explorar. Por ejemplo, podríamos utilizar algún método económico para filtrar las variables más prometedoras y solo hacer inferencias predictivas de proyección sobre ellas. Otra alternativa se conoce como búsqueda directa; es decir, primero ajustamos tantos modelos como variables tenemos. Luego seleccionamos un modelo/variable, el que genera las predicciones más cercanas al modelo de referencia. Luego generamos todos los submodelos con 2 variables que incluyan la variable seleccionada en el paso anterior y así sucesivamente. Si hacemos este procedimiento directo para un modelo de referencia con 8 variables en lugar de 92 modelos diferentes, necesitaremos evaluar solo 36.</p>
<p>Otro aspecto que es relevante considerar al realizar inferencia predictiva por proyección es que solo proporcionamos a prioris para el modelo de referencia. Los submodelos no tienen priors explícitos; simplemente <em>heredan</em> los priors del modelo de referencia a través del procedimiento de proyección.</p>
<p>Una de las razones por las que la predicción proyectiva funciona en la práctica es gracias al uso de un modelo de referencia. Al ajustar los submodelos a las predicciones dentro de la muestra realizadas por el modelo de referencia, en lugar de los datos observados, estamos filtrando el ruido en los datos. Esto ayuda a separar las variables más relevantes de las menos relevantes.</p>
</section>
<section id="selección-de-variables-con-kulprit" class="level2" data-number="7.11">
<h2 data-number="7.11" class="anchored" data-anchor-id="selección-de-variables-con-kulprit"><span class="header-section-number">7.11</span> Selección de variables con Kulprit</h2>
<p>Kulprit es un paquete de Python para inferencia predictiva por proyecciones. Funciona con Bambi, ya que podemos pasar un modelo de referencia creado con él y Kulprit hará todo el trabajo pesado por nosotros.</p>
<p>Para ilustrar cómo usar Kulprit, usaremos el conjunto de datos de grasa corporal. Este conjunto de datos tiene medidas de 251 individuos, incluida su edad, peso, altura, circunferencia del abdomen, etc. Nuestro propósito es predecir el porcentaje de grasa corporal (según lo estimado por la variable <code>siri</code>). Dado que obtener mediciones precisas de la grasa corporal es costoso y potencialmente molesto para los pacientes, queremos reducir las mediciones manteniendo una buena precisión predictiva para <code>siri</code>. El conjunto de datos original incluye 13 variables. Para que este ejemplo sea realmente simple, he preseleccionado 6.</p>
<p>Lo primero que debemos hacer es definir y ajustar un modelo de Bambi, como es habitual. Tenemos que asegurarnos de incluir el argumento <code>idata_kwargs={'log_likelihood':True}}</code>. Internamente, Kulprit calcula el ELPD, usando LOO.</p>
<div id="cell-80" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>body <span class="op">=</span> pd.read_csv(<span class="st">"datos/body_fat.csv"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-81" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>model <span class="op">=</span> bmb.Model(<span class="st">"siri ~ age + weight + height + abdomen + thigh + wrist"</span>,</span>
<span id="cb60-2"><a href="#cb60-2"></a>                  data<span class="op">=</span>body)</span>
<span id="cb60-3"><a href="#cb60-3"></a>idata <span class="op">=</span> model.fit(idata_kwargs<span class="op">=</span>{<span class="st">'log_likelihood'</span>: <span class="va">True</span>})</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [siri_sigma, Intercept, age, weight, height, abdomen, thigh, wrist]
Sampling 4 chains for 1_000 tune and 1_000 draw iterations (4_000 + 4_000 draws total) took 8 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"d3aa55ec10184b92a4f721e1de2523cf","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"></pre>
</div>
</div>
<p>El principal punto de entrada de Kulprir es mediante la clase <code>ProjectionPredictive</code>. Una vez provista del modelo de Bambi y los datos resultantes del ajuste de ese modelo. Podemos pedirle a Kulprit que realice una búsqueda. Este paso puede demorar un rato, es la parte pesada de todo el proceso.</p>
<div id="cell-83" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>ppi <span class="op">=</span> kpt.ProjectionPredictive(model, idata)</span>
<span id="cb62-2"><a href="#cb62-2"></a>ppi.search()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez finalizada la búsqueda, podemos pedirle a Kulprit que compare los submodelos en términos del ELPD. Los submodelos se mostrarán ordenados desde el ELPD más bajo hasta el más alto, como en la siguiente figura</p>
<div id="cell-85" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>ppi.plot_compare(plot<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/osvaldo/proyectos/00_BM/arviz-devs/arviz/arviz/stats/stats.py:792: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.62 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(
/home/osvaldo/proyectos/00_BM/arviz-devs/arviz/arviz/stats/stats.py:792: UserWarning: Estimated shape parameter of Pareto distribution is greater than 0.62 for one or more samples. You should consider using a more robust model, this is because importance sampling is less likely to work well if the marginal posterior and LOO posterior are very different. This is more likely to happen with a non-robust model and highly influential observations.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-44-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>En el eje x, tenemos el tamaño del submodelo, es decir, el número de variables; Comenzamos en cero porque incluimos un modelo con solo un intercepto y sin ninguna covariables. La línea gris discontinua corresponde al ELPD del modelo de referencia.</p>
<p>Podemos ver que un submodelo de tamaño 3 es prácticamente equivalente al modelo de referencia. Pero ¿qué variables se incluyen exactamente en este y otros submodelos? Si imprimimos el objeto <code>ppi</code>, luego de realizar una búsqueda, obtendremos una lista ordenada de las fórmulas de los submodelos que coinciden con el orden en el gráfico obtenido con el comando <code>ppi.plot_compare()</code></p>
<div id="cell-87" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>ppi</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>  0 siri ~ 1
  1 siri ~ abdomen
  2 siri ~ abdomen + weight
  3 siri ~ abdomen + weight + wrist
  4 siri ~ abdomen + weight + wrist + height
  5 siri ~ abdomen + weight + wrist + height + age
  6 siri ~ abdomen + weight + wrist + height + age + thigh</code></pre>
</div>
</div>
<p>El modelo de tamaño 3 es el que incluye las variables <code>abdomen</code>, <code>wrist</code> y <code>height</code>. Este resultado nos dice que si queremos elegir un modelo con menos variables que el modelo de referencia pero con una precisión predictiva similar, entonces esta es una buena opción. Dependiendo del contexto, otros submodelos también pueden ser una buena idea. Por ejemplo, podemos argumentar que la diferencia entre el submodelo de tamaños 2 y 3 es bastante pequeña. Por lo tanto, es posible que estemos dispuestos a sacrificar algo de precisión en favor de un modelo aún más pequeño. Para este ejemplo, medir la altura de los pacientes puede no ser tan problemático, pero para otros escenarios, agregar una tercera variable podría resultar costoso, molesto, peligroso, etc.</p>
<p>Otra forma de interpretar este resultado es notar qué los ELPD para modelos con tamaño 3 o mayor son esencialmente idénticos. Puede darse el caso de que si repetimos el análisis con un conjunto de datos ligeramente diferente, o incluso el mismo conjunto de datos pero con más muestras a posteriori, podamos obtener un orden ligeramente diferente. Por lo tanto, es posible que tengamos otros modelos de tamaño 3 con potencialmente la misma capacidad predictiva, entonces podríamos justificar la selección de la tercera variable por factores externos como qué tan fácil o barato es medirla, o cuál sería menos dolorosa de medir para los pacientes, etc.</p>
<p>En resumen, como ocurre con otras herramientas estadísticas, los resultados no deben tomarse a ciegas sino en contexto; usted deben tener la última palabra y no sus herramientas. Las herramientas solo deben ayudar a fundamentar sus decisiones.</p>
<p>Bien, digamos que efectivamente estamos interesados en el submodelo de tamaño 3 calculado por Kulprit; podemos conseguirlo con:</p>
<div id="cell-89" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>submodelo <span class="op">=</span> ppi.project(<span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Desde el objeto <code>submodel</code>, podemos recuperar información útil como el modelo de Bambi <code>submodelo.model</code> o el objeto InferenceData <code>submodelo.idata</code>.</p>
<p>Una advertencia al interpretar estos dos objetos: <code>submodelo.model</code> es un modelo de Bambi generado a partir de una fórmula. Así, sus priors serán los computados automáticamente por Bambi. Pero el posterior que calcula Kulprit, que está almacenado en <code>submodelo.idata.posterior</code>, no proviene directamente de este modelo. Ya que los priors son “heredados” implícitamente durante el paso de proyección.</p>
<div id="cell-91" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>az.plot_posterior(submodelo.idata, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>¿Podemos confiar en las distribuciones a posteriori proyectados?</p>
<p>En condiciones muy generales, deberían ser distribuciones válidas, lo son al menos para obtener una idea aproximada de los valores de los parámetros y, por supuesto, es suficiente para la selección de variables. La falta de priors explícitos podría dificultar la interpretación del modelo, pero si solo nos importan las predicciones, eso no debería ser un problema. Por supuesto, siempre es posible usar Kulprit para determianr el submodelo y luego Bambi (o PyMC) para calcular explícitamente el posterior de ese modelo adaptado los priors de ser necesario.</p>
<p>La siguiente figura muestra un forestplot para el posteriors del submodelo 3 y para el modelo de referencia. Observe que aquí hay dos posibles fuentes de diferencias: las diferencias entre MCMC y los métodos predictivos por proyección y las diferencias intrínsecas entre los posteriors para ambos modelos.</p>
<div id="cell-93" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>ppi.plot_densities(var_names<span class="op">=</span>[<span class="st">"~Intercept"</span>, <span class="st">"~age"</span>, <span class="st">"~height"</span>, <span class="st">"~thigh"</span>],</span>
<span id="cb69-2"><a href="#cb69-2"></a>                   submodels<span class="op">=</span>[<span class="dv">3</span>],</span>
<span id="cb69-3"><a href="#cb69-3"></a>                   kind<span class="op">=</span><span class="st">"forest"</span>,</span>
<span id="cb69-4"><a href="#cb69-4"></a>                   figsize<span class="op">=</span>(<span class="dv">11</span>, <span class="dv">4</span>),</span>
<span id="cb69-5"><a href="#cb69-5"></a>                   plot_kwargs<span class="op">=</span>{<span class="st">"colors"</span>:[<span class="st">"C0"</span>, <span class="st">"C2"</span>]})<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06_Regresión_lineal_con_Bambi_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./05_Regresión_lineal.html" class="pagination-link" aria-label="Regresión lineal">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresión lineal</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./07_Comparación_de_modelos.html" class="pagination-link" aria-label="Comparación de modelos">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Comparación de modelos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>Este obra está bajo <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">licencia Creative Commons Reconocimiento 4.0 Internacional</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>